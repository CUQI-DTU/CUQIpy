
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gibbs sampling &#8212; cuqipy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=321493ab" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-dropdown.css?v=995e94df" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.min.css?v=21c0b90a" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user/_auto_tutorials/Gibbs';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Joint Distribution tutorial" href="JointDistribution.html" />
    <link rel="prev" title="Samples (Analysis and Visualization)" href="5-Samples.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="https://github.com/CUQI-DTU/CUQIpy/raw/main/logo.png" class="logo__image only-light" alt="cuqipy  documentation - Home"/>
    <img src="https://github.com/CUQI-DTU/CUQIpy/raw/main/logo.png" class="logo__image only-dark pst-js-only" alt="cuqipy  documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Contributor's Guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Contributor's Guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-Basics.html">CUQIpy Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-Models.html">Deterministic models</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-Distributions.html">Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-Samplers.html">Samplers</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-Samples.html">Samples (Analysis and Visualization)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Gibbs sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="JointDistribution.html">Joint Distribution tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultipleInput.html">Multiple input model: bathtub demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="UQ_in_Deconvolution1D.html">Uncertainty Quantification in one-dimensional deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="fun_vec_representation.html">Support vector representation of function values in CUQIpy geometries and samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple_likelihoods.html">Setting a Bayesian model with multiple likelihoods</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_auto_howtos/index.html">How-To Guides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/Deconvolution2D.html">2D Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/Defining_Posterior.html">How to define a Posterior distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/Image2D.html">The use of Image2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/RandomVariablesAndAlgebra.html">Random Variables and Algebra in CUQIpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/TimeDependentLinearPDE.html">Time Dependent Linear PDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/custom_model.html">Custom models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/myula.html">How to sample with MYULA</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Gibbs sampling</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-user-auto-tutorials-gibbs-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="gibbs-sampling">
<span id="sphx-glr-user-auto-tutorials-gibbs-py"></span><h1>Gibbs sampling<a class="headerlink" href="#gibbs-sampling" title="Link to this heading">#</a></h1>
<blockquote>
<div><p>This tutorial shows how to use CUQIpy to perform Gibbs sampling.
Gibbs sampling is a Markov chain Monte Carlo (MCMC) method for
sampling a joint probability distribution.</p>
<p>Opposed to jointly sampling the distribution simultaneously, Gibbs
sampling samples the variables of the distribution sequentially,
one variable at a time. When a variable represents a random vector, the
whole vector is sampled simultaneously.</p>
<p>The sampling of each variable is done by sampling from the conditional
distribution of that variable given (fixed, previously sampled) values
of the other variables.</p>
<p>This is often a very efficient way of sampling from a joint
distribution if the conditional distributions are easy to sample
from. This is one way to exploit the structure of the joint
distribution. On the other hand, if the conditional distributions
are highly correlated and/or are difficult to sample from, then
Gibbs sampling can be very inefficient.</p>
<p>For these reasons, Gibbs sampling is often a double-edged sword,
that needs to be used in the right context.</p>
</div></blockquote>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<p>We start by importing the necessary modules</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cuqi.testproblem</span> <span class="kn">import</span> <span class="n">Deconvolution1D</span>
<span class="kn">from</span> <span class="nn">cuqi.distribution</span> <span class="kn">import</span> <span class="n">Gaussian</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">,</span> <span class="n">JointDistribution</span><span class="p">,</span> <span class="n">GMRF</span><span class="p">,</span> <span class="n">LMRF</span>
<span class="kn">from</span> <span class="nn">cuqi.legacy.sampler</span> <span class="kn">import</span> <span class="n">Gibbs</span><span class="p">,</span> <span class="n">LinearRTO</span><span class="p">,</span> <span class="n">Conjugate</span><span class="p">,</span> <span class="n">UGLA</span><span class="p">,</span> <span class="n">ConjugateApprox</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="forward-model-and-data">
<h2>Forward model and data<a class="headerlink" href="#forward-model-and-data" title="Link to this heading">#</a></h2>
<p>We define the forward model and data.
Here we use a 1D deconvolution problem, so the forward model is linear,
that is:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{A} \mathbf{x}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is the convolution matrix, and <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is the input signal.</p>
<p>We load this example from the testproblem library of CUQIpy and visualize the
true solution (sharp signal) and data (convolved signal).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model and data</span>
<span class="n">A</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">probinfo</span> <span class="o">=</span> <span class="n">Deconvolution1D</span><span class="p">(</span><span class="n">phantom</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_components</span><span class="p">()</span>

<span class="c1"># Get dimension of signal</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">domain_dim</span>

<span class="c1"># Plot exact solution and observed data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">probinfo</span><span class="o">.</span><span class="n">exactSolution</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;exact solution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">y_obs</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Observed data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gibbs_001.png" srcset="../../_images/sphx_glr_Gibbs_001.png" alt="exact solution, Observed data" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Observed data&#39;)
</pre></div>
</div>
</section>
<section id="hierarchical-bayesian-model">
<h2>Hierarchical Bayesian model<a class="headerlink" href="#hierarchical-bayesian-model" title="Link to this heading">#</a></h2>
<p>We define the following hierarchical model:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    d &amp;\sim \mathrm{Gamma}(1, 10^{-4}) \\
    l &amp;\sim \mathrm{Gamma}(1, 10^{-4}) \\
    \mathbf{x} &amp;\sim \mathrm{GMRF}(\mathbf{0}, d) \\
    \mathbf{y} &amp;\sim \mathcal{N}(\mathbf{A} \mathbf{x}, l^{-1} \mathbf{I}_m)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is the observed data, and <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>
is the unknown signal. The hyperparameters <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> are
the precision of the prior distribution of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and
the noise, respectively.</p>
<p>The prior distribution of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is a Gaussian Markov random
field (GMRF) with zero mean and precision <span class="math notranslate nohighlight">\(d\)</span>. It can
be viewed as a Gaussian prior on the differences between neighboring
elements of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>In CUQIpy the model can be defined as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define distributions</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">Gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">GMRF</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">l</span><span class="p">)</span>

<span class="c1"># Combine into a joint distribution</span>
<span class="n">joint</span> <span class="o">=</span> <span class="n">JointDistribution</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># View the joint distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="n">joint</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>JointDistribution(
    Equation:
        p(d,l,x,y) = p(d)p(l)p(x|d)p(y|x,l)
    Densities:
        d ~ CUQI Gamma.
        l ~ CUQI Gamma.
        x ~ CUQI GMRF. Conditioning variables [&#39;d&#39;].
        y ~ CUQI Gaussian. Conditioning variables [&#39;x&#39;, &#39;l&#39;].
 )
</pre></div>
</div>
<p>Notice that the joint distribution prints a mathematical expression
for the density functions that make up <span class="math notranslate nohighlight">\(p(d,l,\mathbf{x},\mathbf{y})\)</span>.
In this case they are all distributions, but this need not be the case.</p>
</section>
<section id="defining-the-posterior-distribution">
<h2>Defining the posterior distribution<a class="headerlink" href="#defining-the-posterior-distribution" title="Link to this heading">#</a></h2>
<p>Now we define the posterior distribution, which is the joint distribution
conditioned on the observed data. That is, <span class="math notranslate nohighlight">\(p(d, l, \mathbf{x} \mid \mathbf{y}=\mathbf{y}_\mathrm{obs})\)</span></p>
<p>This is done in the following way:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define posterior by conditioning on the data</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">joint</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_obs</span><span class="p">)</span>

<span class="c1"># View the structure of the posterior</span>
<span class="nb">print</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>JointDistribution(
    Equation:
        p(d,l,x|y) ∝ p(d)p(l)p(x|d)L(x,l|y)
    Densities:
        d ~ CUQI Gamma.
        l ~ CUQI Gamma.
        x ~ CUQI GMRF. Conditioning variables [&#39;d&#39;].
        y ~ CUQI Gaussian Likelihood function. Parameters [&#39;x&#39;, &#39;l&#39;].
 )
</pre></div>
</div>
<p>Notice that after conditioning on the data, the distribution associated with
<span class="math notranslate nohighlight">\(\mathbf{y}\)</span> became a likelihood function and that the posterior is now
a joint distribution of the variables <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
</section>
<section id="gibbs-sampler">
<h2>Gibbs Sampler<a class="headerlink" href="#gibbs-sampler" title="Link to this heading">#</a></h2>
<p>The hierarchical model above has some important properties that we
can exploit to make the sampling more efficient. First, note that
the Gamma distribution are conjugate priors for the precision of
the Gaussian distributions. This means that we can efficiently sample
from <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> conditional on the other variables.</p>
<p>Second, note that the prior distribution of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is
a Gaussian Markov random field (GMRF) and that the distribution for
<span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is also Gaussian with a Linear operator acting
on <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> as the mean variable. This means that we can
efficiently sample from <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> conditional on the other
variables using the <code class="docutils literal notranslate"><span class="pre">LinearRTO</span></code> sampler.</p>
<p>Taking these two facts into account, we can define a Gibbs sampler
that uses the <code class="docutils literal notranslate"><span class="pre">Conjugate</span></code> sampler for <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> and
the <code class="docutils literal notranslate"><span class="pre">LinearRTO</span></code> sampler for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>This is done in CUQIpy as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define sampling strategy</span>
<span class="n">sampling_strategy</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">LinearRTO</span><span class="p">,</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">Conjugate</span><span class="p">,</span>
    <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">Conjugate</span>
<span class="p">}</span>

<span class="c1"># Define Gibbs sampler</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">Gibbs</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="n">sampling_strategy</span><span class="p">)</span>

<span class="c1"># Run sampler</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">Ns</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">Nb</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/CUQIpy/CUQIpy/demos/tutorials/Gibbs.py:167: UserWarning:
You are using the legacy sampler &#39;Gibbs&#39;.
This will be removed in a future release of CUQIpy.
Please consider using the new samplers in the &#39;cuqi.sampler&#39; module.

  sampler = Gibbs(posterior, sampling_strategy)
/home/runner/work/CUQIpy/CUQIpy/cuqi/legacy/sampler/_rto.py:77: UserWarning:
You are using the legacy sampler &#39;LinearRTO&#39;.
This will be removed in a future release of CUQIpy.
Please consider using the new samplers in the &#39;cuqi.sampler&#39; module.

  super().__init__(target, x0=x0, **kwargs)

Warmup 2 / 200
Warmup 4 / 200
Warmup 6 / 200
Warmup 8 / 200
Warmup 10 / 200
Warmup 12 / 200
Warmup 14 / 200
Warmup 16 / 200
Warmup 18 / 200
Warmup 20 / 200
Warmup 22 / 200
Warmup 24 / 200
Warmup 26 / 200
Warmup 28 / 200
Warmup 30 / 200
Warmup 32 / 200
Warmup 34 / 200
Warmup 36 / 200
Warmup 38 / 200
Warmup 40 / 200
Warmup 42 / 200
Warmup 44 / 200
Warmup 46 / 200
Warmup 48 / 200
Warmup 50 / 200
Warmup 52 / 200
Warmup 54 / 200
Warmup 56 / 200
Warmup 58 / 200
Warmup 60 / 200
Warmup 62 / 200
Warmup 64 / 200
Warmup 66 / 200
Warmup 68 / 200
Warmup 70 / 200
Warmup 72 / 200
Warmup 74 / 200
Warmup 76 / 200
Warmup 78 / 200
Warmup 80 / 200
Warmup 82 / 200
Warmup 84 / 200
Warmup 86 / 200
Warmup 88 / 200
Warmup 90 / 200
Warmup 92 / 200
Warmup 94 / 200
Warmup 96 / 200
Warmup 98 / 200
Warmup 100 / 200
Warmup 102 / 200
Warmup 104 / 200
Warmup 106 / 200
Warmup 108 / 200
Warmup 110 / 200
Warmup 112 / 200
Warmup 114 / 200
Warmup 116 / 200
Warmup 118 / 200
Warmup 120 / 200
Warmup 122 / 200
Warmup 124 / 200
Warmup 126 / 200
Warmup 128 / 200
Warmup 130 / 200
Warmup 132 / 200
Warmup 134 / 200
Warmup 136 / 200
Warmup 138 / 200
Warmup 140 / 200
Warmup 142 / 200
Warmup 144 / 200
Warmup 146 / 200
Warmup 148 / 200
Warmup 150 / 200
Warmup 152 / 200
Warmup 154 / 200
Warmup 156 / 200
Warmup 158 / 200
Warmup 160 / 200
Warmup 162 / 200
Warmup 164 / 200
Warmup 166 / 200
Warmup 168 / 200
Warmup 170 / 200
Warmup 172 / 200
Warmup 174 / 200
Warmup 176 / 200
Warmup 178 / 200
Warmup 180 / 200
Warmup 182 / 200
Warmup 184 / 200
Warmup 186 / 200
Warmup 188 / 200
Warmup 190 / 200
Warmup 192 / 200
Warmup 194 / 200
Warmup 196 / 200
Warmup 198 / 200
Warmup 200 / 200
Warmup 200 / 200

Sample 10 / 1000
Sample 20 / 1000
Sample 30 / 1000
Sample 40 / 1000
Sample 50 / 1000
Sample 60 / 1000
Sample 70 / 1000
Sample 80 / 1000
Sample 90 / 1000
Sample 100 / 1000
Sample 110 / 1000
Sample 120 / 1000
Sample 130 / 1000
Sample 140 / 1000
Sample 150 / 1000
Sample 160 / 1000
Sample 170 / 1000
Sample 180 / 1000
Sample 190 / 1000
Sample 200 / 1000
Sample 210 / 1000
Sample 220 / 1000
Sample 230 / 1000
Sample 240 / 1000
Sample 250 / 1000
Sample 260 / 1000
Sample 270 / 1000
Sample 280 / 1000
Sample 290 / 1000
Sample 300 / 1000
Sample 310 / 1000
Sample 320 / 1000
Sample 330 / 1000
Sample 340 / 1000
Sample 350 / 1000
Sample 360 / 1000
Sample 370 / 1000
Sample 380 / 1000
Sample 390 / 1000
Sample 400 / 1000
Sample 410 / 1000
Sample 420 / 1000
Sample 430 / 1000
Sample 440 / 1000
Sample 450 / 1000
Sample 460 / 1000
Sample 470 / 1000
Sample 480 / 1000
Sample 490 / 1000
Sample 500 / 1000
Sample 510 / 1000
Sample 520 / 1000
Sample 530 / 1000
Sample 540 / 1000
Sample 550 / 1000
Sample 560 / 1000
Sample 570 / 1000
Sample 580 / 1000
Sample 590 / 1000
Sample 600 / 1000
Sample 610 / 1000
Sample 620 / 1000
Sample 630 / 1000
Sample 640 / 1000
Sample 650 / 1000
Sample 660 / 1000
Sample 670 / 1000
Sample 680 / 1000
Sample 690 / 1000
Sample 700 / 1000
Sample 710 / 1000
Sample 720 / 1000
Sample 730 / 1000
Sample 740 / 1000
Sample 750 / 1000
Sample 760 / 1000
Sample 770 / 1000
Sample 780 / 1000
Sample 790 / 1000
Sample 800 / 1000
Sample 810 / 1000
Sample 820 / 1000
Sample 830 / 1000
Sample 840 / 1000
Sample 850 / 1000
Sample 860 / 1000
Sample 870 / 1000
Sample 880 / 1000
Sample 890 / 1000
Sample 900 / 1000
Sample 910 / 1000
Sample 920 / 1000
Sample 930 / 1000
Sample 940 / 1000
Sample 950 / 1000
Sample 960 / 1000
Sample 970 / 1000
Sample 980 / 1000
Sample 990 / 1000
Sample 1000 / 1000
Sample 1000 / 1000
</pre></div>
</div>
</section>
<section id="analyze-results">
<h2>Analyze results<a class="headerlink" href="#analyze-results" title="Link to this heading">#</a></h2>
<p>After sampling we can inspect the results. The samples are stored
as a dictionary with the variable names as keys. Samples for each
variable is stored as a CUQIpy Samples object which contains the
many convenience methods for diagnostics and plotting of MCMC samples.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot credible intervals for the signal</span>
<span class="n">samples</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_ci</span><span class="p">(</span><span class="n">exact</span><span class="o">=</span><span class="n">probinfo</span><span class="o">.</span><span class="n">exactSolution</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gibbs_002.png" srcset="../../_images/sphx_glr_Gibbs_002.png" alt="Gibbs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D object at 0x7f58a85e0260&gt;, &lt;matplotlib.lines.Line2D object at 0x7f58a8715eb0&gt;, &lt;matplotlib.collections.FillBetweenPolyCollection object at 0x7f58a8576c90&gt;]
</pre></div>
</div>
<p>Trace plot for d</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gibbs_003.png" srcset="../../_images/sphx_glr_Gibbs_003.png" alt="d, d" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;d&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;d&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<p>Trace plot for l</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gibbs_004.png" srcset="../../_images/sphx_glr_Gibbs_004.png" alt="l, l" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;l&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;l&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
</section>
<section id="switching-to-a-piecewise-constant-prior">
<h2>Switching to a piecewise constant prior<a class="headerlink" href="#switching-to-a-piecewise-constant-prior" title="Link to this heading">#</a></h2>
<p>Notice that while the sampling went well in the previous example,
the posterior distribution did not match the characteristics of
the exact solution. We can improve this result by switching to a
prior that better matches the exact solution <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>One choice is the Laplace difference prior, which assumes a
Laplace distribution for the differences between neighboring
elements of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. That is,</p>
<div class="math notranslate nohighlight">
\[\mathbf{x} \sim \text{LMRF}(d^{-1}),\]</div>
<p>which means that <span class="math notranslate nohighlight">\(x_i-x_{i-1} \sim \mathrm{Laplace}(0, d^{-1})\)</span>.</p>
<p>This prior is implemented in CUQIpy as the <code class="docutils literal notranslate"><span class="pre">LMRF</span></code> distribution.
To update our model we simply need to replace the <code class="docutils literal notranslate"><span class="pre">GMRF</span></code> distribution
with the <code class="docutils literal notranslate"><span class="pre">LMRF</span></code> distribution. Note that the Laplace distribution
is defined via a scale parameter, so we invert the parameter <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>This laplace distribution and new posterior can be defined as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define new distribution for x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">LMRF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Define new joint distribution with piecewise constant prior</span>
<span class="n">joint_Ld</span> <span class="o">=</span> <span class="n">JointDistribution</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Define new posterior by conditioning on the data</span>
<span class="n">posterior_Ld</span> <span class="o">=</span> <span class="n">joint_Ld</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_obs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">posterior_Ld</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>JointDistribution(
    Equation:
        p(d,l,x|y) ∝ p(d)p(l)p(x|d)L(x,l|y)
    Densities:
        d ~ CUQI Gamma.
        l ~ CUQI Gamma.
        x ~ CUQI LMRF. Conditioning variables [&#39;d&#39;].
        y ~ CUQI Gaussian Likelihood function. Parameters [&#39;x&#39;, &#39;l&#39;].
 )
</pre></div>
</div>
</section>
<section id="gibbs-sampler-with-laplace-prior">
<h2>Gibbs Sampler (with Laplace prior)<a class="headerlink" href="#gibbs-sampler-with-laplace-prior" title="Link to this heading">#</a></h2>
<p>Using the same approach as earlier we can define a Gibbs sampler
for this new hierarchical model. The only difference is that we
now need to use a different sampler for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> because
the <code class="docutils literal notranslate"><span class="pre">LinearRTO</span></code> sampler only works for Gaussian distributions.</p>
<p>In this case we use the UGLA (Unadjusted Gaussian Laplace Approximation) sampler
for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. We also use an approximate Conjugate
sampler for <span class="math notranslate nohighlight">\(d\)</span> which approximately samples from the
posterior distribution of <span class="math notranslate nohighlight">\(d\)</span> conditional on the other
variables in an efficient manner. For more details see e.g.
<cite>this paper &lt;https://arxiv.org/abs/2104.06919&gt;</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define sampling strategy</span>
<span class="n">sampling_strategy</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">UGLA</span><span class="p">,</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">ConjugateApprox</span><span class="p">,</span>
    <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">Conjugate</span>
<span class="p">}</span>

<span class="c1"># Define Gibbs sampler</span>
<span class="n">sampler_Ld</span> <span class="o">=</span> <span class="n">Gibbs</span><span class="p">(</span><span class="n">posterior_Ld</span><span class="p">,</span> <span class="n">sampling_strategy</span><span class="p">)</span>

<span class="c1"># Run sampler</span>
<span class="n">samples_Ld</span> <span class="o">=</span> <span class="n">sampler_Ld</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">Ns</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">Nb</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/CUQIpy/CUQIpy/demos/tutorials/Gibbs.py:254: UserWarning:
You are using the legacy sampler &#39;Gibbs&#39;.
This will be removed in a future release of CUQIpy.
Please consider using the new samplers in the &#39;cuqi.sampler&#39; module.

  sampler_Ld = Gibbs(posterior_Ld, sampling_strategy)
/home/runner/work/CUQIpy/CUQIpy/cuqi/legacy/sampler/_laplace_approximation.py:57: UserWarning:
You are using the legacy sampler &#39;UGLA&#39;.
This will be removed in a future release of CUQIpy.
Please consider using the new samplers in the &#39;cuqi.sampler&#39; module.

  super().__init__(target, x0=x0, **kwargs)

Warmup 2 / 200
Warmup 4 / 200
Warmup 6 / 200
Warmup 8 / 200
Warmup 10 / 200
Warmup 12 / 200
Warmup 14 / 200
Warmup 16 / 200
Warmup 18 / 200
Warmup 20 / 200
Warmup 22 / 200
Warmup 24 / 200
Warmup 26 / 200
Warmup 28 / 200
Warmup 30 / 200
Warmup 32 / 200
Warmup 34 / 200
Warmup 36 / 200
Warmup 38 / 200
Warmup 40 / 200
Warmup 42 / 200
Warmup 44 / 200
Warmup 46 / 200
Warmup 48 / 200
Warmup 50 / 200
Warmup 52 / 200
Warmup 54 / 200
Warmup 56 / 200
Warmup 58 / 200
Warmup 60 / 200
Warmup 62 / 200
Warmup 64 / 200
Warmup 66 / 200
Warmup 68 / 200
Warmup 70 / 200
Warmup 72 / 200
Warmup 74 / 200
Warmup 76 / 200
Warmup 78 / 200
Warmup 80 / 200
Warmup 82 / 200
Warmup 84 / 200
Warmup 86 / 200
Warmup 88 / 200
Warmup 90 / 200
Warmup 92 / 200
Warmup 94 / 200
Warmup 96 / 200
Warmup 98 / 200
Warmup 100 / 200
Warmup 102 / 200
Warmup 104 / 200
Warmup 106 / 200
Warmup 108 / 200
Warmup 110 / 200
Warmup 112 / 200
Warmup 114 / 200
Warmup 116 / 200
Warmup 118 / 200
Warmup 120 / 200
Warmup 122 / 200
Warmup 124 / 200
Warmup 126 / 200
Warmup 128 / 200
Warmup 130 / 200
Warmup 132 / 200
Warmup 134 / 200
Warmup 136 / 200
Warmup 138 / 200
Warmup 140 / 200
Warmup 142 / 200
Warmup 144 / 200
Warmup 146 / 200
Warmup 148 / 200
Warmup 150 / 200
Warmup 152 / 200
Warmup 154 / 200
Warmup 156 / 200
Warmup 158 / 200
Warmup 160 / 200
Warmup 162 / 200
Warmup 164 / 200
Warmup 166 / 200
Warmup 168 / 200
Warmup 170 / 200
Warmup 172 / 200
Warmup 174 / 200
Warmup 176 / 200
Warmup 178 / 200
Warmup 180 / 200
Warmup 182 / 200
Warmup 184 / 200
Warmup 186 / 200
Warmup 188 / 200
Warmup 190 / 200
Warmup 192 / 200
Warmup 194 / 200
Warmup 196 / 200
Warmup 198 / 200
Warmup 200 / 200
Warmup 200 / 200

Sample 10 / 1000
Sample 20 / 1000
Sample 30 / 1000
Sample 40 / 1000
Sample 50 / 1000
Sample 60 / 1000
Sample 70 / 1000
Sample 80 / 1000
Sample 90 / 1000
Sample 100 / 1000
Sample 110 / 1000
Sample 120 / 1000
Sample 130 / 1000
Sample 140 / 1000
Sample 150 / 1000
Sample 160 / 1000
Sample 170 / 1000
Sample 180 / 1000
Sample 190 / 1000
Sample 200 / 1000
Sample 210 / 1000
Sample 220 / 1000
Sample 230 / 1000
Sample 240 / 1000
Sample 250 / 1000
Sample 260 / 1000
Sample 270 / 1000
Sample 280 / 1000
Sample 290 / 1000
Sample 300 / 1000
Sample 310 / 1000
Sample 320 / 1000
Sample 330 / 1000
Sample 340 / 1000
Sample 350 / 1000
Sample 360 / 1000
Sample 370 / 1000
Sample 380 / 1000
Sample 390 / 1000
Sample 400 / 1000
Sample 410 / 1000
Sample 420 / 1000
Sample 430 / 1000
Sample 440 / 1000
Sample 450 / 1000
Sample 460 / 1000
Sample 470 / 1000
Sample 480 / 1000
Sample 490 / 1000
Sample 500 / 1000
Sample 510 / 1000
Sample 520 / 1000
Sample 530 / 1000
Sample 540 / 1000
Sample 550 / 1000
Sample 560 / 1000
Sample 570 / 1000
Sample 580 / 1000
Sample 590 / 1000
Sample 600 / 1000
Sample 610 / 1000
Sample 620 / 1000
Sample 630 / 1000
Sample 640 / 1000
Sample 650 / 1000
Sample 660 / 1000
Sample 670 / 1000
Sample 680 / 1000
Sample 690 / 1000
Sample 700 / 1000
Sample 710 / 1000
Sample 720 / 1000
Sample 730 / 1000
Sample 740 / 1000
Sample 750 / 1000
Sample 760 / 1000
Sample 770 / 1000
Sample 780 / 1000
Sample 790 / 1000
Sample 800 / 1000
Sample 810 / 1000
Sample 820 / 1000
Sample 830 / 1000
Sample 840 / 1000
Sample 850 / 1000
Sample 860 / 1000
Sample 870 / 1000
Sample 880 / 1000
Sample 890 / 1000
Sample 900 / 1000
Sample 910 / 1000
Sample 920 / 1000
Sample 930 / 1000
Sample 940 / 1000
Sample 950 / 1000
Sample 960 / 1000
Sample 970 / 1000
Sample 980 / 1000
Sample 990 / 1000
Sample 1000 / 1000
Sample 1000 / 1000
</pre></div>
</div>
</section>
<section id="id1">
<h2>Analyze results<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Again we can inspect the results.
Here we notice the posterior distribution matches the exact solution much better.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot credible intervals for the signal</span>
<span class="n">samples_Ld</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_ci</span><span class="p">(</span><span class="n">exact</span><span class="o">=</span><span class="n">probinfo</span><span class="o">.</span><span class="n">exactSolution</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gibbs_005.png" srcset="../../_images/sphx_glr_Gibbs_005.png" alt="Gibbs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D object at 0x7f58a62bdfd0&gt;, &lt;matplotlib.lines.Line2D object at 0x7f58a62be270&gt;, &lt;matplotlib.collections.FillBetweenPolyCollection object at 0x7f58a6212540&gt;]
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples_Ld</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gibbs_006.png" srcset="../../_images/sphx_glr_Gibbs_006.png" alt="d, d" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;d&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;d&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples_Ld</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_Gibbs_007.png" srcset="../../_images/sphx_glr_Gibbs_007.png" alt="l, l" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;l&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;l&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 30.946 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-user-auto-tutorials-gibbs-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/cd9ad4a23e965748f3d5000b2c73232c/Gibbs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">Gibbs.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/d5ebe9bd234521e13d81eba23ad7dc83/Gibbs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">Gibbs.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b0a74c3d5153ac186aa2dc0ecd3fa7ac/Gibbs.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">Gibbs.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-model-and-data">Forward model and data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-bayesian-model">Hierarchical Bayesian model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-posterior-distribution">Defining the posterior distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gibbs-sampler">Gibbs Sampler</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-results">Analyze results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#switching-to-a-piecewise-constant-prior">Switching to a piecewise constant prior</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gibbs-sampler-with-laplace-prior">Gibbs Sampler (with Laplace prior)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Analyze results</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/_auto_tutorials/Gibbs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022, CUQI Project, Technical University of Denmark (DTU).
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>