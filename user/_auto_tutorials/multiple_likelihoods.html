
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Setting a Bayesian model with multiple likelihoods &#8212; cuqipy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=321493ab" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-dropdown.css?v=995e94df" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.min.css?v=21c0b90a" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user/_auto_tutorials/multiple_likelihoods';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How-To Guides" href="../_auto_howtos/index.html" />
    <link rel="prev" title="Support vector representation of function values in CUQIpy geometries and samples" href="fun_vec_representation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="https://github.com/CUQI-DTU/CUQIpy/raw/main/logo.png" class="logo__image only-light" alt="cuqipy  documentation - Home"/>
    <img src="https://github.com/CUQI-DTU/CUQIpy/raw/main/logo.png" class="logo__image only-dark pst-js-only" alt="cuqipy  documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Contributor's Guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Contributor's Guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-Basics.html">CUQIpy Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-Models.html">Deterministic models</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-Distributions.html">Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-Samplers.html">Samplers</a></li>
<li class="toctree-l2"><a class="reference internal" href="5-Samples.html">Samples (Analysis and Visualization)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Gibbs.html">Gibbs sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="JointDistribution.html">Joint Distribution tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultipleInput.html">Multiple input model: bathtub demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="UQ_in_Deconvolution1D.html">Uncertainty Quantification in one-dimensional deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="fun_vec_representation.html">Support vector representation of function values in CUQIpy geometries and samples</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Setting a Bayesian model with multiple likelihoods</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../_auto_howtos/index.html">How-To Guides</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/Deconvolution2D.html">2D Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/Defining_Posterior.html">How to define a Posterior distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/Image2D.html">The use of Image2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/RandomVariablesAndAlgebra.html">Random Variables and Algebra in CUQIpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/TimeDependentLinearPDE.html">Time Dependent Linear PDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/custom_model.html">Custom models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_auto_howtos/myula.html">How to sample with MYULA</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Setting a Bayesian model with multiple likelihoods</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-user-auto-tutorials-multiple-likelihoods-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="setting-a-bayesian-model-with-multiple-likelihoods">
<span id="sphx-glr-user-auto-tutorials-multiple-likelihoods-py"></span><h1>Setting a Bayesian model with multiple likelihoods<a class="headerlink" href="#setting-a-bayesian-model-with-multiple-likelihoods" title="Link to this heading">#</a></h1>
<p>In this example we build a PDE-based Bayesian inverse problem where the Bayesian
model has multiple likelihood functions (two different likelihood functions in
this case, but it can be readily extended to more functions) for the same
Bayesian parameter <cite>theta</cite>, which represents the conductivity parameters in a
1D Poisson problem. Each likelihood is associated with a different model set
up. The models we use here are obtained from the test problem
<a class="reference internal" href="../../api/_autosummary/cuqi.testproblem/cuqi.testproblem.Poisson1D.html#cuqi.testproblem.Poisson1D" title="cuqi.testproblem.Poisson1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">cuqi.testproblem.Poisson1D</span></code></a>. See the class
<a class="reference internal" href="../../api/_autosummary/cuqi.testproblem/cuqi.testproblem.Poisson1D.html#cuqi.testproblem.Poisson1D" title="cuqi.testproblem.Poisson1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">cuqi.testproblem.Poisson1D</span></code></a> documentation for more details about the
forward model.</p>
<p>First we import the python libraries needed.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cuqi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">ceil</span>
</pre></div>
</div>
<section id="choose-one-of-the-two-cases-we-study-in-this-demo">
<h2>Choose one of the two cases we study in this demo<a class="headerlink" href="#choose-one-of-the-two-cases-we-study-in-this-demo" title="Link to this heading">#</a></h2>
<p>We can choose between two cases:
Choose <cite>set_up = set_ups[0]</cite> for the case where we have two 1D Poisson models
that differ in the observation operator only. And choose <cite>set_up = set_ups[1]</cite>
for the case where we have two 1D Poisson models that differ in the source
term only. Here we demonstrate the first case, <cite>set_up = set_ups[0]</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">set_ups</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;multi_observation&quot;</span><span class="p">,</span> <span class="s2">&quot;multi_source&quot;</span><span class="p">]</span>
<span class="n">set_up</span> <span class="o">=</span> <span class="n">set_ups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">set_up</span> <span class="o">==</span> <span class="s2">&quot;multi_observation&quot;</span> <span class="ow">or</span> <span class="n">set_up</span> <span class="o">==</span> <span class="s2">&quot;multi_source&quot;</span><span class="p">,</span>\
    <span class="s2">&quot;set_up must be either &#39;multi_observation&#39; or &#39;multi_source&#39;&quot;</span>
</pre></div>
</div>
</section>
<section id="set-up-the-parameters-used-in-both-models">
<h2>Set up the parameters used in both models<a class="headerlink" href="#set-up-the-parameters-used-in-both-models" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Number of the model grid points</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># The model domain is the interval [0, endpoint]</span>
<span class="n">field_type</span> <span class="o">=</span> <span class="s2">&quot;Step&quot;</span>  <span class="c1"># The conductivity (or diffusivity) field type.</span>
                     <span class="c1"># We choose step function parameterization here.</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">400</span>  <span class="c1"># Signal-to-noise ratio</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Number of steps in the conductivity (or diffusivity) step field</span>
<span class="n">magnitude</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Magnitude of the source term in the Poisson problem</span>

<span class="c1"># Exact solution</span>
<span class="n">x_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="n">x_exact</span><span class="p">[:</span><span class="n">ceil</span><span class="p">(</span><span class="n">dim</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">x_exact</span><span class="p">[</span><span class="n">ceil</span><span class="p">(</span><span class="n">dim</span><span class="o">/</span><span class="mi">2</span><span class="p">):]</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</section>
<section id="set-up-the-first-model">
<h2>Set up the first model<a class="headerlink" href="#set-up-the-first-model" title="Link to this heading">#</a></h2>
<p>We set up the first forward model to have observations at the first half of
the domain (or observation everywhere if <cite>set_up = set_ups[1]</cite>). We then plot
the true conductivity field (the exact solution), the exact data and the noisy
data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">observation_grid_map1</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">set_up</span> <span class="o">==</span> <span class="s2">&quot;multi_observation&quot;</span><span class="p">:</span>
    <span class="c1"># Observe on the first half of the domain</span>
    <span class="n">observation_grid_map1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="mf">.5</span><span class="p">)]</span>

<span class="c1"># The source term signal</span>
<span class="n">source1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xs</span><span class="p">:</span> <span class="n">magnitude</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xs</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">endpoint</span><span class="p">)</span><span class="o">+</span><span class="n">magnitude</span>

<span class="c1"># Obtain the forward model from the test problem</span>
<span class="n">model1</span><span class="p">,</span> <span class="n">data1</span><span class="p">,</span> <span class="n">problemInfo1</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">testproblem</span><span class="o">.</span><span class="n">Poisson1D</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
    <span class="n">field_type</span><span class="o">=</span><span class="n">field_type</span><span class="p">,</span>
    <span class="n">field_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_steps&quot;</span><span class="p">:</span> <span class="n">n_steps</span><span class="p">},</span>
    <span class="n">observation_grid_map</span><span class="o">=</span><span class="n">observation_grid_map1</span><span class="p">,</span>
    <span class="n">exactSolution</span><span class="o">=</span><span class="n">x_exact</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="n">source1</span><span class="p">,</span>
    <span class="n">SNR</span><span class="o">=</span><span class="n">SNR</span><span class="p">)</span><span class="o">.</span><span class="n">get_components</span><span class="p">()</span>

<span class="c1"># Plot data, exact data and exact solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">data1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">problemInfo1</span><span class="o">.</span><span class="n">exactData</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact data&#39;</span><span class="p">)</span>
<span class="n">problemInfo1</span><span class="o">.</span><span class="n">exactSolution</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact solution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_multiple_likelihoods_001.png" srcset="../../_images/sphx_glr_multiple_likelihoods_001.png" alt="multiple likelihoods" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f58a2f6a6c0&gt;
</pre></div>
</div>
</section>
<section id="set-up-the-second-model">
<h2>Set up the second model<a class="headerlink" href="#set-up-the-second-model" title="Link to this heading">#</a></h2>
<p>We set up the second forward model to have observations at the second half of
the domain (or observation everywhere and and different source term if
<cite>set_up = set_ups[1]</cite>). We then plot the true conductivity field (the exact
solution), the exact data and the noisy data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">observation_grid_map2</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">set_up</span> <span class="o">==</span> <span class="s2">&quot;multi_observation&quot;</span><span class="p">:</span>
        <span class="c1"># Observe on the second half of the domain</span>
    <span class="n">observation_grid_map2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="mf">.5</span><span class="p">)]</span>

<span class="c1"># The source term signal</span>
<span class="k">if</span> <span class="n">set_up</span> <span class="o">==</span> <span class="s2">&quot;multi_source&quot;</span><span class="p">:</span>
    <span class="n">source2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xs</span><span class="p">:</span> <span class="n">magnitude</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">xs</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">endpoint</span><span class="p">)</span><span class="o">+</span><span class="n">magnitude</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">source2</span> <span class="o">=</span> <span class="n">source1</span>

<span class="c1"># Obtain the forward model from the test problem</span>
<span class="n">model2</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">problemInfo2</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">testproblem</span><span class="o">.</span><span class="n">Poisson1D</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
    <span class="n">field_type</span><span class="o">=</span><span class="n">field_type</span><span class="p">,</span>
    <span class="n">field_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_steps&quot;</span><span class="p">:</span> <span class="n">n_steps</span><span class="p">},</span>
    <span class="n">observation_grid_map</span><span class="o">=</span><span class="n">observation_grid_map2</span><span class="p">,</span>
    <span class="n">exactSolution</span><span class="o">=</span><span class="n">x_exact</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="n">source2</span><span class="p">,</span>
    <span class="n">SNR</span><span class="o">=</span><span class="n">SNR</span><span class="p">)</span><span class="o">.</span><span class="n">get_components</span><span class="p">()</span>

<span class="c1"># Plot data, exact data and exact solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">data2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;data2&#39;</span><span class="p">)</span>
<span class="n">problemInfo2</span><span class="o">.</span><span class="n">exactData</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact data2&#39;</span><span class="p">)</span>
<span class="n">problemInfo2</span><span class="o">.</span><span class="n">exactSolution</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact solution2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_multiple_likelihoods_002.png" srcset="../../_images/sphx_glr_multiple_likelihoods_002.png" alt="multiple likelihoods" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f58a2dcef30&gt;
</pre></div>
</div>
</section>
<section id="create-the-prior">
<h2>Create the prior<a class="headerlink" href="#create-the-prior" title="Link to this heading">#</a></h2>
<p>Create the prior for the Bayesian parameter <cite>theta</cite>, which is the expansion
coefficients of the conductivity (or diffusivity) step function. We use a
Gaussian prior.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span>
    <span class="n">mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">domain_dim</span><span class="p">),</span>
    <span class="n">cov</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">geometry</span><span class="o">=</span><span class="n">model1</span><span class="o">.</span><span class="n">domain_geometry</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-the-data-distributions-using-the-two-forward-models">
<h2>Create the data distributions using the two forward models<a class="headerlink" href="#create-the-data-distributions-using-the-two-forward-models" title="Link to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate the data noise standard deviation</span>
<span class="n">sigma_noise1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">problemInfo1</span><span class="o">.</span><span class="n">exactData</span><span class="p">)</span><span class="o">/</span><span class="n">SNR</span>
<span class="n">sigma_noise2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">problemInfo2</span><span class="o">.</span><span class="n">exactData</span><span class="p">)</span><span class="o">/</span><span class="n">SNR</span>

<span class="c1"># Create the data distributions</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span>
    <span class="n">mean</span><span class="o">=</span><span class="n">model1</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
    <span class="n">cov</span><span class="o">=</span><span class="n">sigma_noise1</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">geometry</span><span class="o">=</span><span class="n">model1</span><span class="o">.</span><span class="n">range_geometry</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span>
    <span class="n">mean</span><span class="o">=</span><span class="n">model2</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
    <span class="n">cov</span><span class="o">=</span><span class="n">sigma_noise2</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">geometry</span><span class="o">=</span><span class="n">model2</span><span class="o">.</span><span class="n">range_geometry</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="formulate-the-bayesian-inverse-problem-using-the-first-data-distribution-single-likelihood">
<h2>Formulate the Bayesian inverse problem using the first data distribution (single likelihood)<a class="headerlink" href="#formulate-the-bayesian-inverse-problem-using-the-first-data-distribution-single-likelihood" title="Link to this heading">#</a></h2>
<p>We first formulate the Bayesian inverse problem using the first data distribution and analyze the posterior samples.</p>
<section id="create-the-posterior">
<h3>Create the posterior<a class="headerlink" href="#create-the-posterior" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">z1</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">JointDistribution</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">y1</span><span class="p">)(</span><span class="n">y1</span><span class="o">=</span><span class="n">data1</span><span class="p">)</span>
</pre></div>
</div>
<p>We print the joint distribution <cite>z1</cite>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Posterior(
    Equation:
         p(theta|y1) ∝ L(theta|y1)p(theta)
    Densities:
        y1 ~ CUQI Gaussian Likelihood function. Parameters [&#39;theta&#39;].
        theta ~ CUQI Gaussian.
 )
</pre></div>
</div>
<p>We see that we obtain a <a class="reference internal" href="../../api/_autosummary/cuqi.distribution/cuqi.distribution.Posterior.html#cuqi.distribution.Posterior" title="cuqi.distribution.Posterior"><code class="xref py py-class docutils literal notranslate"><span class="pre">cuqi.distribution.Posterior</span></code></a> object, which
represents the posterior distribution of the parameters <cite>theta</cite> given the data
<cite>y1</cite>. The posterior distribution in this case is proportional to the product
of the likelihood obtained from the first data distribution and the prior.</p>
</section>
<section id="sample-from-the-posterior">
<h3>Sample from the posterior<a class="headerlink" href="#sample-from-the-posterior" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample from the posterior</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">legacy</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MH</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample_adapt</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>

<span class="c1"># Plot the credible interval and compute the ESS</span>
<span class="n">samples</span><span class="o">.</span><span class="n">burnthin</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">plot_ci</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="n">problemInfo1</span><span class="o">.</span><span class="n">exactSolution</span><span class="p">)</span>
<span class="n">samples</span><span class="o">.</span><span class="n">compute_ess</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_multiple_likelihoods_003.png" srcset="../../_images/sphx_glr_multiple_likelihoods_003.png" alt="multiple likelihoods" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/CUQIpy/CUQIpy/cuqi/legacy/sampler/_sampler.py:156: UserWarning:
You are using the legacy sampler &#39;MH&#39;.
This will be removed in a future release of CUQIpy.
Please consider using the new samplers in the &#39;cuqi.sampler&#39; module.

  super().__init__(target, x0=x0, dim=dim, **kwargs)

Sample 80 / 8000
Sample 160 / 8000
Sample 240 / 8000
Sample 320 / 8000
Sample 400 / 8000
Sample 480 / 8000
Sample 560 / 8000
Sample 640 / 8000
Sample 720 / 8000
Sample 800 / 8000
Sample 880 / 8000
Sample 960 / 8000
Sample 1040 / 8000
Sample 1120 / 8000
Sample 1200 / 8000
Sample 1280 / 8000
Sample 1360 / 8000
Sample 1440 / 8000
Sample 1520 / 8000
Sample 1600 / 8000
Sample 1680 / 8000
Sample 1760 / 8000
Sample 1840 / 8000
Sample 1920 / 8000
Sample 2000 / 8000
Sample 2080 / 8000
Sample 2160 / 8000
Sample 2240 / 8000
Sample 2320 / 8000
Sample 2400 / 8000
Sample 2480 / 8000
Sample 2560 / 8000
Sample 2640 / 8000
Sample 2720 / 8000
Sample 2800 / 8000
Sample 2880 / 8000
Sample 2960 / 8000
Sample 3040 / 8000
Sample 3120 / 8000
Sample 3200 / 8000
Sample 3280 / 8000
Sample 3360 / 8000
Sample 3440 / 8000
Sample 3520 / 8000
Sample 3600 / 8000
Sample 3680 / 8000
Sample 3760 / 8000
Sample 3840 / 8000
Sample 3920 / 8000
Sample 4000 / 8000
Sample 4080 / 8000
Sample 4160 / 8000
Sample 4240 / 8000
Sample 4320 / 8000
Sample 4400 / 8000
Sample 4480 / 8000
Sample 4560 / 8000
Sample 4640 / 8000
Sample 4720 / 8000
Sample 4800 / 8000
Sample 4880 / 8000
Sample 4960 / 8000
Sample 5040 / 8000
Sample 5120 / 8000
Sample 5200 / 8000
Sample 5280 / 8000
Sample 5360 / 8000
Sample 5440 / 8000
Sample 5520 / 8000
Sample 5600 / 8000
Sample 5680 / 8000
Sample 5760 / 8000
Sample 5840 / 8000
Sample 5920 / 8000
Sample 6000 / 8000
Sample 6080 / 8000
Sample 6160 / 8000
Sample 6240 / 8000
Sample 6320 / 8000
Sample 6400 / 8000
Sample 6480 / 8000
Sample 6560 / 8000
Sample 6640 / 8000
Sample 6720 / 8000
Sample 6800 / 8000
Sample 6880 / 8000
Sample 6960 / 8000
Sample 7040 / 8000
Sample 7120 / 8000
Sample 7200 / 8000
Sample 7280 / 8000
Sample 7360 / 8000
Sample 7440 / 8000
Sample 7520 / 8000
Sample 7600 / 8000
Sample 7680 / 8000
Sample 7760 / 8000
Sample 7840 / 8000
Sample 7920 / 8000
Sample 8000 / 8000
Sample 8000 / 8000

Average acceptance rate: 0.108375 MCMC scale: 0.05370189213198375


array([172.13470253, 109.82438384])
</pre></div>
</div>
</section>
</section>
<section id="formulate-the-bayesian-inverse-problem-using-the-second-data-distribution-single-likelihood">
<h2>Formulate the Bayesian inverse problem using the second data distribution (single likelihood)<a class="headerlink" href="#formulate-the-bayesian-inverse-problem-using-the-second-data-distribution-single-likelihood" title="Link to this heading">#</a></h2>
<p>We then formulate the Bayesian inverse problem using the second data distribution and analyze the posterior samples.</p>
<section id="id1">
<h3>Create the posterior<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">z2</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">JointDistribution</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">y2</span><span class="p">)(</span><span class="n">y2</span><span class="o">=</span><span class="n">data2</span><span class="p">)</span>
</pre></div>
</div>
<p>We print the joint distribution <cite>z2</cite>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Posterior(
    Equation:
         p(theta|y2) ∝ L(theta|y2)p(theta)
    Densities:
        y2 ~ CUQI Gaussian Likelihood function. Parameters [&#39;theta&#39;].
        theta ~ CUQI Gaussian.
 )
</pre></div>
</div>
<p>We see that we obtain a <a class="reference internal" href="../../api/_autosummary/cuqi.distribution/cuqi.distribution.Posterior.html#cuqi.distribution.Posterior" title="cuqi.distribution.Posterior"><code class="xref py py-class docutils literal notranslate"><span class="pre">cuqi.distribution.Posterior</span></code></a> object, which
represents the posterior distribution of the parameters <cite>theta</cite> given the data
<cite>y2</cite>. The posterior distribution in this case is proportional to the product
of the likelihood obtained from the second data distribution and the prior.</p>
</section>
<section id="id2">
<h3>Sample from the posterior<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample from the posterior</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">legacy</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MH</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample_adapt</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>

<span class="c1"># Plot the credible interval and compute the ESS</span>
<span class="n">samples</span><span class="o">.</span><span class="n">burnthin</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">plot_ci</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="n">problemInfo1</span><span class="o">.</span><span class="n">exactSolution</span><span class="p">)</span>
<span class="n">samples</span><span class="o">.</span><span class="n">compute_ess</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_multiple_likelihoods_004.png" srcset="../../_images/sphx_glr_multiple_likelihoods_004.png" alt="multiple likelihoods" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/CUQIpy/CUQIpy/cuqi/legacy/sampler/_sampler.py:156: UserWarning:
You are using the legacy sampler &#39;MH&#39;.
This will be removed in a future release of CUQIpy.
Please consider using the new samplers in the &#39;cuqi.sampler&#39; module.

  super().__init__(target, x0=x0, dim=dim, **kwargs)

Sample 80 / 8000
Sample 160 / 8000
Sample 240 / 8000
Sample 320 / 8000
Sample 400 / 8000
Sample 480 / 8000
Sample 560 / 8000
Sample 640 / 8000
Sample 720 / 8000
Sample 800 / 8000
Sample 880 / 8000
Sample 960 / 8000
Sample 1040 / 8000
Sample 1120 / 8000
Sample 1200 / 8000
Sample 1280 / 8000
Sample 1360 / 8000
Sample 1440 / 8000
Sample 1520 / 8000
Sample 1600 / 8000
Sample 1680 / 8000
Sample 1760 / 8000
Sample 1840 / 8000
Sample 1920 / 8000
Sample 2000 / 8000
Sample 2080 / 8000
Sample 2160 / 8000
Sample 2240 / 8000
Sample 2320 / 8000
Sample 2400 / 8000
Sample 2480 / 8000
Sample 2560 / 8000
Sample 2640 / 8000
Sample 2720 / 8000
Sample 2800 / 8000
Sample 2880 / 8000
Sample 2960 / 8000
Sample 3040 / 8000
Sample 3120 / 8000
Sample 3200 / 8000
Sample 3280 / 8000
Sample 3360 / 8000
Sample 3440 / 8000
Sample 3520 / 8000
Sample 3600 / 8000
Sample 3680 / 8000
Sample 3760 / 8000
Sample 3840 / 8000
Sample 3920 / 8000
Sample 4000 / 8000
Sample 4080 / 8000
Sample 4160 / 8000
Sample 4240 / 8000
Sample 4320 / 8000
Sample 4400 / 8000
Sample 4480 / 8000
Sample 4560 / 8000
Sample 4640 / 8000
Sample 4720 / 8000
Sample 4800 / 8000
Sample 4880 / 8000
Sample 4960 / 8000
Sample 5040 / 8000
Sample 5120 / 8000
Sample 5200 / 8000
Sample 5280 / 8000
Sample 5360 / 8000
Sample 5440 / 8000
Sample 5520 / 8000
Sample 5600 / 8000
Sample 5680 / 8000
Sample 5760 / 8000
Sample 5840 / 8000
Sample 5920 / 8000
Sample 6000 / 8000
Sample 6080 / 8000
Sample 6160 / 8000
Sample 6240 / 8000
Sample 6320 / 8000
Sample 6400 / 8000
Sample 6480 / 8000
Sample 6560 / 8000
Sample 6640 / 8000
Sample 6720 / 8000
Sample 6800 / 8000
Sample 6880 / 8000
Sample 6960 / 8000
Sample 7040 / 8000
Sample 7120 / 8000
Sample 7200 / 8000
Sample 7280 / 8000
Sample 7360 / 8000
Sample 7440 / 8000
Sample 7520 / 8000
Sample 7600 / 8000
Sample 7680 / 8000
Sample 7760 / 8000
Sample 7840 / 8000
Sample 7920 / 8000
Sample 8000 / 8000
Sample 8000 / 8000

Average acceptance rate: 0.146 MCMC scale: 0.0650357574625219


array([27.69442058, 24.71006971])
</pre></div>
</div>
</section>
</section>
<section id="formulate-the-bayesian-inverse-problem-using-both-data-distributions-multiple-likelihoods">
<h2>Formulate the Bayesian inverse problem using both data distributions (multiple likelihoods)<a class="headerlink" href="#formulate-the-bayesian-inverse-problem-using-both-data-distributions-multiple-likelihoods" title="Link to this heading">#</a></h2>
<p>We then formulate the Bayesian inverse problem using both data distributions and analyze the posterior samples.</p>
<section id="id3">
<h3>Create the posterior<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">z_joint</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">JointDistribution</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">)(</span><span class="n">y1</span><span class="o">=</span><span class="n">data1</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="n">data2</span><span class="p">)</span>
</pre></div>
</div>
<p>We print the joint distribution <cite>z_joint</cite>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">z_joint</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>MultipleLikelihoodPosterior(
    Equation:
        p(theta|y1,y2) ∝ p(theta)L(theta|y1)L(theta|y2)
    Densities:
        theta ~ CUQI Gaussian.
        y1 ~ CUQI Gaussian Likelihood function. Parameters [&#39;theta&#39;].
        y2 ~ CUQI Gaussian Likelihood function. Parameters [&#39;theta&#39;].
 )
</pre></div>
</div>
<p>We see that in this case we obtain a <code class="xref py py-class docutils literal notranslate"><span class="pre">MultipleLikelihoodPosterior</span></code>
object, which represents the posterior distribution of the parameters <cite>theta</cite>
given the data <cite>y1</cite> and <cite>y2</cite>. The posterior distribution in this case is
proportional to the product of the two likelihoods and the prior.</p>
</section>
<section id="id4">
<h3>Sample from the posterior<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample from the posterior</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">cuqi</span><span class="o">.</span><span class="n">legacy</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MH</span><span class="p">(</span><span class="n">z_joint</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">sample_adapt</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>

<span class="c1"># Plot the credible interval and compute the ESS</span>
<span class="n">samples</span><span class="o">.</span><span class="n">burnthin</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">plot_ci</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="n">problemInfo1</span><span class="o">.</span><span class="n">exactSolution</span><span class="p">)</span>
<span class="n">samples</span><span class="o">.</span><span class="n">compute_ess</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_multiple_likelihoods_005.png" srcset="../../_images/sphx_glr_multiple_likelihoods_005.png" alt="multiple likelihoods" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/CUQIpy/CUQIpy/cuqi/legacy/sampler/_sampler.py:156: UserWarning:
You are using the legacy sampler &#39;MH&#39;.
This will be removed in a future release of CUQIpy.
Please consider using the new samplers in the &#39;cuqi.sampler&#39; module.

  super().__init__(target, x0=x0, dim=dim, **kwargs)

Sample 80 / 8000
Sample 160 / 8000
Sample 240 / 8000
Sample 320 / 8000
Sample 400 / 8000
Sample 480 / 8000
Sample 560 / 8000
Sample 640 / 8000
Sample 720 / 8000
Sample 800 / 8000
Sample 880 / 8000
Sample 960 / 8000
Sample 1040 / 8000
Sample 1120 / 8000
Sample 1200 / 8000
Sample 1280 / 8000
Sample 1360 / 8000
Sample 1440 / 8000
Sample 1520 / 8000
Sample 1600 / 8000
Sample 1680 / 8000
Sample 1760 / 8000
Sample 1840 / 8000
Sample 1920 / 8000
Sample 2000 / 8000
Sample 2080 / 8000
Sample 2160 / 8000
Sample 2240 / 8000
Sample 2320 / 8000
Sample 2400 / 8000
Sample 2480 / 8000
Sample 2560 / 8000
Sample 2640 / 8000
Sample 2720 / 8000
Sample 2800 / 8000
Sample 2880 / 8000
Sample 2960 / 8000
Sample 3040 / 8000
Sample 3120 / 8000
Sample 3200 / 8000
Sample 3280 / 8000
Sample 3360 / 8000
Sample 3440 / 8000
Sample 3520 / 8000
Sample 3600 / 8000
Sample 3680 / 8000
Sample 3760 / 8000
Sample 3840 / 8000
Sample 3920 / 8000
Sample 4000 / 8000
Sample 4080 / 8000
Sample 4160 / 8000
Sample 4240 / 8000
Sample 4320 / 8000
Sample 4400 / 8000
Sample 4480 / 8000
Sample 4560 / 8000
Sample 4640 / 8000
Sample 4720 / 8000
Sample 4800 / 8000
Sample 4880 / 8000
Sample 4960 / 8000
Sample 5040 / 8000
Sample 5120 / 8000
Sample 5200 / 8000
Sample 5280 / 8000
Sample 5360 / 8000
Sample 5440 / 8000
Sample 5520 / 8000
Sample 5600 / 8000
Sample 5680 / 8000
Sample 5760 / 8000
Sample 5840 / 8000
Sample 5920 / 8000
Sample 6000 / 8000
Sample 6080 / 8000
Sample 6160 / 8000
Sample 6240 / 8000
Sample 6320 / 8000
Sample 6400 / 8000
Sample 6480 / 8000
Sample 6560 / 8000
Sample 6640 / 8000
Sample 6720 / 8000
Sample 6800 / 8000
Sample 6880 / 8000
Sample 6960 / 8000
Sample 7040 / 8000
Sample 7120 / 8000
Sample 7200 / 8000
Sample 7280 / 8000
Sample 7360 / 8000
Sample 7440 / 8000
Sample 7520 / 8000
Sample 7600 / 8000
Sample 7680 / 8000
Sample 7760 / 8000
Sample 7840 / 8000
Sample 7920 / 8000
Sample 8000 / 8000
Sample 8000 / 8000

Average acceptance rate: 0.067375 MCMC scale: 0.04423692692875009


array([225.17033864, 219.04385327])
</pre></div>
</div>
<p>We notice that combining the two data distributions leads to a more certain
estimate of the conductivity (using the same number of MCMC iterations).
This is because including the two different data sets in the inversion is more
informative than the single data set case. Also, the effective sample size is
larger than (or comparable to) what is obtained in any of the single data
distribution case.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 17.970 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-user-auto-tutorials-multiple-likelihoods-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4bb26f30d460827eada164091ea0b27a/multiple_likelihoods.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">multiple_likelihoods.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1dfdf0bd627baf682bd81b8a7ad191a1/multiple_likelihoods.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">multiple_likelihoods.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4b8894361a7c9cd8e78bc49d745b573e/multiple_likelihoods.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">multiple_likelihoods.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-one-of-the-two-cases-we-study-in-this-demo">Choose one of the two cases we study in this demo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-parameters-used-in-both-models">Set up the parameters used in both models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-first-model">Set up the first model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-the-second-model">Set up the second model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-prior">Create the prior</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-data-distributions-using-the-two-forward-models">Create the data distributions using the two forward models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formulate-the-bayesian-inverse-problem-using-the-first-data-distribution-single-likelihood">Formulate the Bayesian inverse problem using the first data distribution (single likelihood)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-posterior">Create the posterior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-from-the-posterior">Sample from the posterior</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formulate-the-bayesian-inverse-problem-using-the-second-data-distribution-single-likelihood">Formulate the Bayesian inverse problem using the second data distribution (single likelihood)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Create the posterior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Sample from the posterior</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formulate-the-bayesian-inverse-problem-using-both-data-distributions-multiple-likelihoods">Formulate the Bayesian inverse problem using both data distributions (multiple likelihoods)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Create the posterior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Sample from the posterior</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/_auto_tutorials/multiple_likelihoods.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022, CUQI Project, Technical University of Denmark (DTU).
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>