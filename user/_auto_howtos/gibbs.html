
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gibbs sampling &#8212; cuqipy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=321493ab" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-dropdown.css?v=995e94df" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.min.css?v=21c0b90a" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user/_auto_howtos/gibbs';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The use of Image2D" href="image_2d.html" />
    <link rel="prev" title="Support vector representation of function values in CUQIpy geometries and samples" href="fun_vec_representation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="https://github.com/CUQI-DTU/CUQIpy/raw/main/logo.png" class="logo__image only-light" alt="cuqipy  documentation - Home"/>
    <img src="https://github.com/CUQI-DTU/CUQIpy/raw/main/logo.png" class="logo__image only-dark pst-js-only" alt="cuqipy  documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Contributor's Guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev/index.html">
    Contributor's Guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_auto_tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">How-To Guides</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="deconvolution_2d.html">2D Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="defining_posterior.html">How to define a Posterior distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="fun_vec_representation.html">Support vector representation of function values in CUQIpy geometries and samples</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Gibbs sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_2d.html">The use of Image2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="joint_distribution.html">Joint Distribution tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple_input.html">Multiple input model: bathtub demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple_likelihoods.html">Setting a Bayesian model with multiple likelihoods</a></li>
<li class="toctree-l2"><a class="reference internal" href="myula.html">How to sample with MYULA</a></li>
<li class="toctree-l2"><a class="reference internal" href="random_variables_and_algebra.html">Random Variables and Algebra in CUQIpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_dependent_linear_pde.html">Time Dependent Linear PDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="uq_in_deconvolution_1d.html">Uncertainty Quantification in one-dimensional deconvolution</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">How-To Guides</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Gibbs sampling</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-user-auto-howtos-gibbs-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="gibbs-sampling">
<span id="sphx-glr-user-auto-howtos-gibbs-py"></span><h1>Gibbs sampling<a class="headerlink" href="#gibbs-sampling" title="Link to this heading">#</a></h1>
<blockquote>
<div><p>This tutorial shows how to use CUQIpy to perform Gibbs sampling.
Gibbs sampling is a Markov chain Monte Carlo (MCMC) method for
sampling a joint probability distribution.</p>
<p>Opposed to jointly sampling the distribution simultaneously, Gibbs
sampling samples the variables of the distribution sequentially,
one variable at a time. When a variable represents a random vector, the
whole vector is sampled simultaneously.</p>
<p>The sampling of each variable is done by sampling from the conditional
distribution of that variable given (fixed, previously sampled) values
of the other variables.</p>
<p>This is often a very efficient way of sampling from a joint
distribution if the conditional distributions are easy to sample
from. This is one way to exploit the structure of the joint
distribution. On the other hand, if the conditional distributions
are highly correlated and/or are difficult to sample from, then
Gibbs sampling can be very inefficient.</p>
<p>For these reasons, Gibbs sampling is often a double-edged sword,
that needs to be used in the right context.</p>
</div></blockquote>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<p>We start by importing the necessary modules</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cuqi.testproblem</span> <span class="kn">import</span> <span class="n">Deconvolution1D</span>
<span class="kn">from</span> <span class="nn">cuqi.distribution</span> <span class="kn">import</span> <span class="n">Gaussian</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">,</span> <span class="n">JointDistribution</span><span class="p">,</span> <span class="n">GMRF</span><span class="p">,</span> <span class="n">LMRF</span>
<span class="kn">from</span> <span class="nn">cuqi.sampler</span> <span class="kn">import</span> <span class="n">HybridGibbs</span><span class="p">,</span> <span class="n">LinearRTO</span><span class="p">,</span> <span class="n">Conjugate</span><span class="p">,</span> <span class="n">UGLA</span><span class="p">,</span> <span class="n">ConjugateApprox</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="forward-model-and-data">
<h2>Forward model and data<a class="headerlink" href="#forward-model-and-data" title="Link to this heading">#</a></h2>
<p>We define the forward model and data.
Here we use a 1D deconvolution problem, so the forward model is linear,
that is:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{A} \mathbf{x}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is the convolution matrix, and <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is the input signal.</p>
<p>We load this example from the testproblem library of CUQIpy and visualize the
true solution (sharp signal) and data (convolved signal).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model and data</span>
<span class="n">A</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">probinfo</span> <span class="o">=</span> <span class="n">Deconvolution1D</span><span class="p">(</span><span class="n">phantom</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_components</span><span class="p">()</span>

<span class="c1"># Get dimension of signal</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">domain_dim</span>

<span class="c1"># Plot exact solution and observed data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">probinfo</span><span class="o">.</span><span class="n">exactSolution</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;exact solution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">y_obs</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Observed data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_gibbs_001.png" srcset="../../_images/sphx_glr_gibbs_001.png" alt="exact solution, Observed data" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Observed data&#39;)
</pre></div>
</div>
</section>
<section id="hierarchical-bayesian-model">
<h2>Hierarchical Bayesian model<a class="headerlink" href="#hierarchical-bayesian-model" title="Link to this heading">#</a></h2>
<p>We define the following hierarchical model:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
    d &amp;\sim \mathrm{Gamma}(1, 10^{-4}) \\
    l &amp;\sim \mathrm{Gamma}(1, 10^{-4}) \\
    \mathbf{x} &amp;\sim \mathrm{GMRF}(\mathbf{0}, d) \\
    \mathbf{y} &amp;\sim \mathcal{N}(\mathbf{A} \mathbf{x}, l^{-1} \mathbf{I}_m)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is the observed data, and <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>
is the unknown signal. The hyperparameters <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> are
the precision of the prior distribution of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and
the noise, respectively.</p>
<p>The prior distribution of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is a Gaussian Markov random
field (GMRF) with zero mean and precision <span class="math notranslate nohighlight">\(d\)</span>. It can
be viewed as a Gaussian prior on the differences between neighboring
elements of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>In CUQIpy the model can be defined as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define distributions</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">Gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">GMRF</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">l</span><span class="p">)</span>

<span class="c1"># Combine into a joint distribution</span>
<span class="n">joint</span> <span class="o">=</span> <span class="n">JointDistribution</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># View the joint distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="n">joint</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>JointDistribution(
    Equation:
        p(d,l,x,y) = p(d)p(l)p(x|d)p(y|x,l)
    Densities:
        d ~ CUQI Gamma.
        l ~ CUQI Gamma.
        x ~ CUQI GMRF. Conditioning variables [&#39;d&#39;].
        y ~ CUQI Gaussian. Conditioning variables [&#39;x&#39;, &#39;l&#39;].
 )
</pre></div>
</div>
<p>Notice that the joint distribution prints a mathematical expression
for the density functions that make up <span class="math notranslate nohighlight">\(p(d,l,\mathbf{x},\mathbf{y})\)</span>.
In this case they are all distributions, but this need not be the case.</p>
</section>
<section id="defining-the-posterior-distribution">
<h2>Defining the posterior distribution<a class="headerlink" href="#defining-the-posterior-distribution" title="Link to this heading">#</a></h2>
<p>Now we define the posterior distribution, which is the joint distribution
conditioned on the observed data. That is, <span class="math notranslate nohighlight">\(p(d, l, \mathbf{x} \mid \mathbf{y}=\mathbf{y}_\mathrm{obs})\)</span></p>
<p>This is done in the following way:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define posterior by conditioning on the data</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">joint</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_obs</span><span class="p">)</span>

<span class="c1"># View the structure of the posterior</span>
<span class="nb">print</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>JointDistribution(
    Equation:
        p(d,l,x|y) ∝ p(d)p(l)p(x|d)L(x,l|y)
    Densities:
        d ~ CUQI Gamma.
        l ~ CUQI Gamma.
        x ~ CUQI GMRF. Conditioning variables [&#39;d&#39;].
        y ~ CUQI Gaussian Likelihood function. Parameters [&#39;x&#39;, &#39;l&#39;].
 )
</pre></div>
</div>
<p>Notice that after conditioning on the data, the distribution associated with
<span class="math notranslate nohighlight">\(\mathbf{y}\)</span> became a likelihood function and that the posterior is now
a joint distribution of the variables <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
</section>
<section id="gibbs-sampler">
<h2>Gibbs Sampler<a class="headerlink" href="#gibbs-sampler" title="Link to this heading">#</a></h2>
<p>The hierarchical model above has some important properties that we
can exploit to make the sampling more efficient. First, note that
the Gamma distribution are conjugate priors for the precision of
the Gaussian distributions. This means that we can efficiently sample
from <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> conditional on the other variables.</p>
<p>Second, note that the prior distribution of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is
a Gaussian Markov random field (GMRF) and that the distribution for
<span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is also Gaussian with a Linear operator acting
on <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> as the mean variable. This means that we can
efficiently sample from <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> conditional on the other
variables using the <code class="docutils literal notranslate"><span class="pre">LinearRTO</span></code> sampler.</p>
<p>Taking these two facts into account, we can define a HybridGibbs sampler
that uses the <code class="docutils literal notranslate"><span class="pre">Conjugate</span></code> sampler for <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> and
the <code class="docutils literal notranslate"><span class="pre">LinearRTO</span></code> sampler for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>This is done in CUQIpy as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define sampling strategy</span>
<span class="n">sampling_strategy</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">LinearRTO</span><span class="p">(),</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">Conjugate</span><span class="p">(),</span>
    <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">Conjugate</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1"># Define HybridGibbs sampler</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">HybridGibbs</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="n">sampling_strategy</span><span class="p">)</span>

<span class="c1"># Run sampler</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">warmup</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">get_samples</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Warmup:   0%|          | 0/200 [00:00&lt;?, ?it/s]
Warmup:   8%|▊         | 15/200 [00:00&lt;00:01, 140.28it/s]
Warmup:  15%|█▌        | 30/200 [00:00&lt;00:01, 141.53it/s]
Warmup:  22%|██▎       | 45/200 [00:00&lt;00:01, 141.53it/s]
Warmup:  30%|███       | 60/200 [00:00&lt;00:00, 141.70it/s]
Warmup:  38%|███▊      | 75/200 [00:00&lt;00:00, 141.69it/s]
Warmup:  45%|████▌     | 90/200 [00:00&lt;00:00, 140.49it/s]
Warmup:  52%|█████▎    | 105/200 [00:00&lt;00:00, 141.06it/s]
Warmup:  60%|██████    | 120/200 [00:00&lt;00:00, 141.33it/s]
Warmup:  68%|██████▊   | 135/200 [00:00&lt;00:00, 141.75it/s]
Warmup:  75%|███████▌  | 150/200 [00:01&lt;00:00, 141.76it/s]
Warmup:  82%|████████▎ | 165/200 [00:01&lt;00:00, 142.03it/s]
Warmup:  90%|█████████ | 180/200 [00:01&lt;00:00, 142.16it/s]
Warmup:  98%|█████████▊| 195/200 [00:01&lt;00:00, 142.26it/s]
Warmup: 100%|██████████| 200/200 [00:01&lt;00:00, 141.72it/s]

Sample:   0%|          | 0/1000 [00:00&lt;?, ?it/s]
Sample:   2%|▏         | 15/1000 [00:00&lt;00:06, 143.07it/s]
Sample:   3%|▎         | 30/1000 [00:00&lt;00:06, 143.00it/s]
Sample:   4%|▍         | 45/1000 [00:00&lt;00:06, 143.08it/s]
Sample:   6%|▌         | 60/1000 [00:00&lt;00:06, 142.59it/s]
Sample:   8%|▊         | 75/1000 [00:00&lt;00:06, 141.56it/s]
Sample:   9%|▉         | 90/1000 [00:00&lt;00:06, 141.96it/s]
Sample:  10%|█         | 105/1000 [00:00&lt;00:06, 140.97it/s]
Sample:  12%|█▏        | 120/1000 [00:00&lt;00:06, 141.41it/s]
Sample:  14%|█▎        | 135/1000 [00:00&lt;00:06, 141.63it/s]
Sample:  15%|█▌        | 150/1000 [00:01&lt;00:05, 141.87it/s]
Sample:  16%|█▋        | 165/1000 [00:01&lt;00:05, 141.97it/s]
Sample:  18%|█▊        | 180/1000 [00:01&lt;00:05, 142.13it/s]
Sample:  20%|█▉        | 195/1000 [00:01&lt;00:05, 142.17it/s]
Sample:  21%|██        | 210/1000 [00:01&lt;00:05, 142.22it/s]
Sample:  22%|██▎       | 225/1000 [00:01&lt;00:05, 142.40it/s]
Sample:  24%|██▍       | 240/1000 [00:01&lt;00:05, 142.17it/s]
Sample:  26%|██▌       | 255/1000 [00:01&lt;00:05, 142.39it/s]
Sample:  27%|██▋       | 270/1000 [00:01&lt;00:05, 142.43it/s]
Sample:  28%|██▊       | 285/1000 [00:02&lt;00:05, 142.46it/s]
Sample:  30%|███       | 300/1000 [00:02&lt;00:04, 142.52it/s]
Sample:  32%|███▏      | 315/1000 [00:02&lt;00:04, 142.66it/s]
Sample:  33%|███▎      | 330/1000 [00:02&lt;00:04, 142.83it/s]
Sample:  34%|███▍      | 345/1000 [00:02&lt;00:04, 142.78it/s]
Sample:  36%|███▌      | 360/1000 [00:02&lt;00:04, 142.91it/s]
Sample:  38%|███▊      | 375/1000 [00:02&lt;00:04, 142.49it/s]
Sample:  39%|███▉      | 390/1000 [00:02&lt;00:04, 142.73it/s]
Sample:  40%|████      | 405/1000 [00:02&lt;00:04, 142.85it/s]
Sample:  42%|████▏     | 420/1000 [00:02&lt;00:04, 142.83it/s]
Sample:  44%|████▎     | 435/1000 [00:03&lt;00:03, 142.91it/s]
Sample:  45%|████▌     | 450/1000 [00:03&lt;00:03, 142.92it/s]
Sample:  46%|████▋     | 465/1000 [00:03&lt;00:03, 143.07it/s]
Sample:  48%|████▊     | 480/1000 [00:03&lt;00:03, 142.95it/s]
Sample:  50%|████▉     | 495/1000 [00:03&lt;00:03, 142.93it/s]
Sample:  51%|█████     | 510/1000 [00:03&lt;00:03, 142.89it/s]
Sample:  52%|█████▎    | 525/1000 [00:03&lt;00:03, 142.97it/s]
Sample:  54%|█████▍    | 540/1000 [00:03&lt;00:03, 142.94it/s]
Sample:  56%|█████▌    | 555/1000 [00:03&lt;00:03, 142.92it/s]
Sample:  57%|█████▋    | 570/1000 [00:03&lt;00:03, 142.65it/s]
Sample:  58%|█████▊    | 585/1000 [00:04&lt;00:02, 142.53it/s]
Sample:  60%|██████    | 600/1000 [00:04&lt;00:02, 142.75it/s]
Sample:  62%|██████▏   | 615/1000 [00:04&lt;00:02, 142.82it/s]
Sample:  63%|██████▎   | 630/1000 [00:04&lt;00:02, 142.80it/s]
Sample:  64%|██████▍   | 645/1000 [00:04&lt;00:02, 142.68it/s]
Sample:  66%|██████▌   | 660/1000 [00:04&lt;00:02, 142.74it/s]
Sample:  68%|██████▊   | 675/1000 [00:04&lt;00:02, 142.84it/s]
Sample:  69%|██████▉   | 690/1000 [00:04&lt;00:02, 142.95it/s]
Sample:  70%|███████   | 705/1000 [00:04&lt;00:02, 142.79it/s]
Sample:  72%|███████▏  | 720/1000 [00:05&lt;00:01, 142.70it/s]
Sample:  74%|███████▎  | 735/1000 [00:05&lt;00:01, 142.73it/s]
Sample:  75%|███████▌  | 750/1000 [00:05&lt;00:01, 142.81it/s]
Sample:  76%|███████▋  | 765/1000 [00:05&lt;00:01, 142.96it/s]
Sample:  78%|███████▊  | 780/1000 [00:05&lt;00:01, 143.00it/s]
Sample:  80%|███████▉  | 795/1000 [00:05&lt;00:01, 142.99it/s]
Sample:  81%|████████  | 810/1000 [00:05&lt;00:01, 143.03it/s]
Sample:  82%|████████▎ | 825/1000 [00:05&lt;00:01, 143.02it/s]
Sample:  84%|████████▍ | 840/1000 [00:05&lt;00:01, 143.12it/s]
Sample:  86%|████████▌ | 855/1000 [00:05&lt;00:01, 143.08it/s]
Sample:  87%|████████▋ | 870/1000 [00:06&lt;00:00, 143.16it/s]
Sample:  88%|████████▊ | 885/1000 [00:06&lt;00:00, 143.10it/s]
Sample:  90%|█████████ | 900/1000 [00:06&lt;00:00, 143.07it/s]
Sample:  92%|█████████▏| 915/1000 [00:06&lt;00:00, 142.93it/s]
Sample:  93%|█████████▎| 930/1000 [00:06&lt;00:00, 142.94it/s]
Sample:  94%|█████████▍| 945/1000 [00:06&lt;00:00, 143.04it/s]
Sample:  96%|█████████▌| 960/1000 [00:06&lt;00:00, 142.99it/s]
Sample:  98%|█████████▊| 975/1000 [00:06&lt;00:00, 142.98it/s]
Sample:  99%|█████████▉| 990/1000 [00:06&lt;00:00, 142.79it/s]
Sample: 100%|██████████| 1000/1000 [00:07&lt;00:00, 142.68it/s]
</pre></div>
</div>
</section>
<section id="analyze-results">
<h2>Analyze results<a class="headerlink" href="#analyze-results" title="Link to this heading">#</a></h2>
<p>After sampling we can inspect the results. The samples are stored
as a dictionary with the variable names as keys. Samples for each
variable is stored as a CUQIpy Samples object which contains the
many convenience methods for diagnostics and plotting of MCMC samples.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot credible intervals for the signal</span>
<span class="n">samples</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_ci</span><span class="p">(</span><span class="n">exact</span><span class="o">=</span><span class="n">probinfo</span><span class="o">.</span><span class="n">exactSolution</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_gibbs_002.png" srcset="../../_images/sphx_glr_gibbs_002.png" alt="gibbs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D object at 0x7fa8afccef00&gt;, &lt;matplotlib.lines.Line2D object at 0x7fa8afe89070&gt;, &lt;matplotlib.collections.FillBetweenPolyCollection object at 0x7fa8afda6e70&gt;]
</pre></div>
</div>
<p>Trace plot for d</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_gibbs_003.png" srcset="../../_images/sphx_glr_gibbs_003.png" alt="d, d" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;d&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;d&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<p>Trace plot for l</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_gibbs_004.png" srcset="../../_images/sphx_glr_gibbs_004.png" alt="l, l" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;l&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;l&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
</section>
<section id="switching-to-a-piecewise-constant-prior">
<h2>Switching to a piecewise constant prior<a class="headerlink" href="#switching-to-a-piecewise-constant-prior" title="Link to this heading">#</a></h2>
<p>Notice that while the sampling went well in the previous example,
the posterior distribution did not match the characteristics of
the exact solution. We can improve this result by switching to a
prior that better matches the exact solution <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>One choice is the Laplace difference prior, which assumes a
Laplace distribution for the differences between neighboring
elements of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. That is,</p>
<div class="math notranslate nohighlight">
\[\mathbf{x} \sim \text{LMRF}(d^{-1}),\]</div>
<p>which means that <span class="math notranslate nohighlight">\(x_i-x_{i-1} \sim \mathrm{Laplace}(0, d^{-1})\)</span>.</p>
<p>This prior is implemented in CUQIpy as the <code class="docutils literal notranslate"><span class="pre">LMRF</span></code> distribution.
To update our model we simply need to replace the <code class="docutils literal notranslate"><span class="pre">GMRF</span></code> distribution
with the <code class="docutils literal notranslate"><span class="pre">LMRF</span></code> distribution. Note that the Laplace distribution
is defined via a scale parameter, so we invert the parameter <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>This laplace distribution and new posterior can be defined as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define new distribution for x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">LMRF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Define new joint distribution with piecewise constant prior</span>
<span class="n">joint_Ld</span> <span class="o">=</span> <span class="n">JointDistribution</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Define new posterior by conditioning on the data</span>
<span class="n">posterior_Ld</span> <span class="o">=</span> <span class="n">joint_Ld</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_obs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">posterior_Ld</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>JointDistribution(
    Equation:
        p(d,l,x|y) ∝ p(d)p(l)p(x|d)L(x,l|y)
    Densities:
        d ~ CUQI Gamma.
        l ~ CUQI Gamma.
        x ~ CUQI LMRF. Conditioning variables [&#39;d&#39;].
        y ~ CUQI Gaussian Likelihood function. Parameters [&#39;x&#39;, &#39;l&#39;].
 )
</pre></div>
</div>
</section>
<section id="hybridgibbs-sampler-with-laplace-prior">
<h2>HybridGibbs Sampler (with Laplace prior)<a class="headerlink" href="#hybridgibbs-sampler-with-laplace-prior" title="Link to this heading">#</a></h2>
<p>Using the same approach as earlier we can define a HybridGibbs sampler
for this new hierarchical model. The only difference is that we
now need to use a different sampler for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> because
the <code class="docutils literal notranslate"><span class="pre">LinearRTO</span></code> sampler only works for Gaussian distributions.</p>
<p>In this case we use the UGLA (Unadjusted Gaussian Laplace Approximation) sampler
for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. We also use an approximate Conjugate
sampler for <span class="math notranslate nohighlight">\(d\)</span> which approximately samples from the
posterior distribution of <span class="math notranslate nohighlight">\(d\)</span> conditional on the other
variables in an efficient manner. For more details see e.g.
<cite>this paper &lt;https://arxiv.org/abs/2104.06919&gt;</cite>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define sampling strategy</span>
<span class="n">sampling_strategy</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">UGLA</span><span class="p">(),</span>
    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">ConjugateApprox</span><span class="p">(),</span>
    <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">Conjugate</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1"># Define Gibbs sampler</span>
<span class="n">sampler_Ld</span> <span class="o">=</span> <span class="n">HybridGibbs</span><span class="p">(</span><span class="n">posterior_Ld</span><span class="p">,</span> <span class="n">sampling_strategy</span><span class="p">)</span>

<span class="c1"># Run sampler</span>
<span class="n">sampler_Ld</span><span class="o">.</span><span class="n">warmup</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="n">sampler_Ld</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">samples_Ld</span> <span class="o">=</span> <span class="n">sampler_Ld</span><span class="o">.</span><span class="n">get_samples</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Warmup:   0%|          | 0/200 [00:00&lt;?, ?it/s]
Warmup:   3%|▎         | 6/200 [00:00&lt;00:03, 56.76it/s]
Warmup:   6%|▌         | 12/200 [00:00&lt;00:03, 56.63it/s]
Warmup:   9%|▉         | 18/200 [00:00&lt;00:03, 56.54it/s]
Warmup:  12%|█▏        | 24/200 [00:00&lt;00:03, 56.66it/s]
Warmup:  15%|█▌        | 30/200 [00:00&lt;00:03, 56.61it/s]
Warmup:  18%|█▊        | 36/200 [00:00&lt;00:02, 56.64it/s]
Warmup:  21%|██        | 42/200 [00:00&lt;00:02, 56.75it/s]
Warmup:  24%|██▍       | 48/200 [00:00&lt;00:02, 56.79it/s]
Warmup:  27%|██▋       | 54/200 [00:00&lt;00:02, 56.81it/s]
Warmup:  30%|███       | 60/200 [00:01&lt;00:02, 56.82it/s]
Warmup:  33%|███▎      | 66/200 [00:01&lt;00:02, 56.84it/s]
Warmup:  36%|███▌      | 72/200 [00:01&lt;00:02, 56.86it/s]
Warmup:  39%|███▉      | 78/200 [00:01&lt;00:02, 56.93it/s]
Warmup:  42%|████▏     | 84/200 [00:01&lt;00:02, 56.96it/s]
Warmup:  45%|████▌     | 90/200 [00:01&lt;00:01, 57.06it/s]
Warmup:  48%|████▊     | 96/200 [00:01&lt;00:01, 56.93it/s]
Warmup:  51%|█████     | 102/200 [00:01&lt;00:01, 56.97it/s]
Warmup:  54%|█████▍    | 108/200 [00:01&lt;00:01, 56.95it/s]
Warmup:  57%|█████▋    | 114/200 [00:02&lt;00:01, 56.97it/s]
Warmup:  60%|██████    | 120/200 [00:02&lt;00:01, 57.04it/s]
Warmup:  63%|██████▎   | 126/200 [00:02&lt;00:01, 57.09it/s]
Warmup:  66%|██████▌   | 132/200 [00:02&lt;00:01, 57.09it/s]
Warmup:  69%|██████▉   | 138/200 [00:02&lt;00:01, 56.97it/s]
Warmup:  72%|███████▏  | 144/200 [00:02&lt;00:00, 57.00it/s]
Warmup:  75%|███████▌  | 150/200 [00:02&lt;00:00, 57.07it/s]
Warmup:  78%|███████▊  | 156/200 [00:02&lt;00:00, 57.05it/s]
Warmup:  81%|████████  | 162/200 [00:02&lt;00:00, 57.06it/s]
Warmup:  84%|████████▍ | 168/200 [00:02&lt;00:00, 57.01it/s]
Warmup:  87%|████████▋ | 174/200 [00:03&lt;00:00, 56.99it/s]
Warmup:  90%|█████████ | 180/200 [00:03&lt;00:00, 56.97it/s]
Warmup:  93%|█████████▎| 186/200 [00:03&lt;00:00, 56.96it/s]
Warmup:  96%|█████████▌| 192/200 [00:03&lt;00:00, 56.97it/s]
Warmup:  99%|█████████▉| 198/200 [00:03&lt;00:00, 57.00it/s]
Warmup: 100%|██████████| 200/200 [00:03&lt;00:00, 56.92it/s]

Sample:   0%|          | 0/1000 [00:00&lt;?, ?it/s]
Sample:   1%|          | 6/1000 [00:00&lt;00:17, 57.10it/s]
Sample:   1%|          | 12/1000 [00:00&lt;00:17, 57.04it/s]
Sample:   2%|▏         | 18/1000 [00:00&lt;00:17, 57.10it/s]
Sample:   2%|▏         | 24/1000 [00:00&lt;00:17, 57.15it/s]
Sample:   3%|▎         | 30/1000 [00:00&lt;00:16, 57.15it/s]
Sample:   4%|▎         | 36/1000 [00:00&lt;00:16, 57.28it/s]
Sample:   4%|▍         | 42/1000 [00:00&lt;00:16, 57.33it/s]
Sample:   5%|▍         | 48/1000 [00:00&lt;00:16, 57.25it/s]
Sample:   5%|▌         | 54/1000 [00:00&lt;00:16, 57.21it/s]
Sample:   6%|▌         | 60/1000 [00:01&lt;00:16, 57.29it/s]
Sample:   7%|▋         | 66/1000 [00:01&lt;00:16, 56.83it/s]
Sample:   7%|▋         | 72/1000 [00:01&lt;00:16, 57.04it/s]
Sample:   8%|▊         | 78/1000 [00:01&lt;00:16, 57.16it/s]
Sample:   8%|▊         | 84/1000 [00:01&lt;00:15, 57.30it/s]
Sample:   9%|▉         | 90/1000 [00:01&lt;00:15, 57.36it/s]
Sample:  10%|▉         | 96/1000 [00:01&lt;00:15, 57.26it/s]
Sample:  10%|█         | 102/1000 [00:01&lt;00:15, 57.31it/s]
Sample:  11%|█         | 108/1000 [00:01&lt;00:15, 57.35it/s]
Sample:  11%|█▏        | 114/1000 [00:01&lt;00:15, 57.38it/s]
Sample:  12%|█▏        | 120/1000 [00:02&lt;00:15, 57.45it/s]
Sample:  13%|█▎        | 126/1000 [00:02&lt;00:15, 57.42it/s]
Sample:  13%|█▎        | 132/1000 [00:02&lt;00:15, 57.45it/s]
Sample:  14%|█▍        | 138/1000 [00:02&lt;00:14, 57.51it/s]
Sample:  14%|█▍        | 144/1000 [00:02&lt;00:14, 57.59it/s]
Sample:  15%|█▌        | 150/1000 [00:02&lt;00:14, 57.50it/s]
Sample:  16%|█▌        | 156/1000 [00:02&lt;00:14, 57.49it/s]
Sample:  16%|█▌        | 162/1000 [00:02&lt;00:14, 57.44it/s]
Sample:  17%|█▋        | 168/1000 [00:02&lt;00:14, 57.50it/s]
Sample:  17%|█▋        | 174/1000 [00:03&lt;00:14, 57.55it/s]
Sample:  18%|█▊        | 180/1000 [00:03&lt;00:14, 57.53it/s]
Sample:  19%|█▊        | 186/1000 [00:03&lt;00:14, 57.50it/s]
Sample:  19%|█▉        | 192/1000 [00:03&lt;00:14, 57.54it/s]
Sample:  20%|█▉        | 198/1000 [00:03&lt;00:13, 57.30it/s]
Sample:  20%|██        | 204/1000 [00:03&lt;00:13, 57.38it/s]
Sample:  21%|██        | 210/1000 [00:03&lt;00:13, 57.36it/s]
Sample:  22%|██▏       | 216/1000 [00:03&lt;00:13, 57.43it/s]
Sample:  22%|██▏       | 222/1000 [00:03&lt;00:13, 57.48it/s]
Sample:  23%|██▎       | 228/1000 [00:03&lt;00:13, 57.50it/s]
Sample:  23%|██▎       | 234/1000 [00:04&lt;00:13, 57.53it/s]
Sample:  24%|██▍       | 240/1000 [00:04&lt;00:13, 57.51it/s]
Sample:  25%|██▍       | 246/1000 [00:04&lt;00:13, 57.52it/s]
Sample:  25%|██▌       | 252/1000 [00:04&lt;00:12, 57.54it/s]
Sample:  26%|██▌       | 258/1000 [00:04&lt;00:12, 57.53it/s]
Sample:  26%|██▋       | 264/1000 [00:04&lt;00:12, 57.53it/s]
Sample:  27%|██▋       | 270/1000 [00:04&lt;00:12, 57.49it/s]
Sample:  28%|██▊       | 276/1000 [00:04&lt;00:12, 57.44it/s]
Sample:  28%|██▊       | 282/1000 [00:04&lt;00:12, 57.43it/s]
Sample:  29%|██▉       | 288/1000 [00:05&lt;00:12, 57.33it/s]
Sample:  29%|██▉       | 294/1000 [00:05&lt;00:12, 57.38it/s]
Sample:  30%|███       | 300/1000 [00:05&lt;00:12, 57.39it/s]
Sample:  31%|███       | 306/1000 [00:05&lt;00:12, 57.43it/s]
Sample:  31%|███       | 312/1000 [00:05&lt;00:11, 57.46it/s]
Sample:  32%|███▏      | 318/1000 [00:05&lt;00:11, 57.59it/s]
Sample:  32%|███▏      | 324/1000 [00:05&lt;00:11, 57.58it/s]
Sample:  33%|███▎      | 330/1000 [00:05&lt;00:11, 57.65it/s]
Sample:  34%|███▎      | 336/1000 [00:05&lt;00:11, 57.63it/s]
Sample:  34%|███▍      | 342/1000 [00:05&lt;00:11, 57.66it/s]
Sample:  35%|███▍      | 348/1000 [00:06&lt;00:11, 57.66it/s]
Sample:  35%|███▌      | 354/1000 [00:06&lt;00:11, 57.44it/s]
Sample:  36%|███▌      | 360/1000 [00:06&lt;00:11, 57.53it/s]
Sample:  37%|███▋      | 366/1000 [00:06&lt;00:11, 57.49it/s]
Sample:  37%|███▋      | 372/1000 [00:06&lt;00:10, 57.49it/s]
Sample:  38%|███▊      | 378/1000 [00:06&lt;00:10, 57.47it/s]
Sample:  38%|███▊      | 384/1000 [00:06&lt;00:10, 57.54it/s]
Sample:  39%|███▉      | 390/1000 [00:06&lt;00:10, 57.47it/s]
Sample:  40%|███▉      | 396/1000 [00:06&lt;00:10, 57.50it/s]
Sample:  40%|████      | 402/1000 [00:07&lt;00:10, 57.58it/s]
Sample:  41%|████      | 408/1000 [00:07&lt;00:10, 57.65it/s]
Sample:  41%|████▏     | 414/1000 [00:07&lt;00:10, 57.62it/s]
Sample:  42%|████▏     | 420/1000 [00:07&lt;00:10, 57.61it/s]
Sample:  43%|████▎     | 426/1000 [00:07&lt;00:09, 57.62it/s]
Sample:  43%|████▎     | 432/1000 [00:07&lt;00:09, 57.62it/s]
Sample:  44%|████▍     | 438/1000 [00:07&lt;00:09, 57.62it/s]
Sample:  44%|████▍     | 444/1000 [00:07&lt;00:09, 57.54it/s]
Sample:  45%|████▌     | 450/1000 [00:07&lt;00:09, 57.51it/s]
Sample:  46%|████▌     | 456/1000 [00:07&lt;00:09, 57.26it/s]
Sample:  46%|████▌     | 462/1000 [00:08&lt;00:09, 57.35it/s]
Sample:  47%|████▋     | 468/1000 [00:08&lt;00:09, 57.19it/s]
Sample:  47%|████▋     | 474/1000 [00:08&lt;00:09, 57.23it/s]
Sample:  48%|████▊     | 480/1000 [00:08&lt;00:09, 57.27it/s]
Sample:  49%|████▊     | 486/1000 [00:08&lt;00:08, 57.37it/s]
Sample:  49%|████▉     | 492/1000 [00:08&lt;00:08, 57.45it/s]
Sample:  50%|████▉     | 498/1000 [00:08&lt;00:08, 57.46it/s]
Sample:  50%|█████     | 504/1000 [00:08&lt;00:08, 57.52it/s]
Sample:  51%|█████     | 510/1000 [00:08&lt;00:08, 57.41it/s]
Sample:  52%|█████▏    | 516/1000 [00:08&lt;00:08, 57.30it/s]
Sample:  52%|█████▏    | 522/1000 [00:09&lt;00:08, 57.41it/s]
Sample:  53%|█████▎    | 528/1000 [00:09&lt;00:08, 57.37it/s]
Sample:  53%|█████▎    | 534/1000 [00:09&lt;00:08, 57.47it/s]
Sample:  54%|█████▍    | 540/1000 [00:09&lt;00:08, 57.42it/s]
Sample:  55%|█████▍    | 546/1000 [00:09&lt;00:07, 57.46it/s]
Sample:  55%|█████▌    | 552/1000 [00:09&lt;00:07, 57.52it/s]
Sample:  56%|█████▌    | 558/1000 [00:09&lt;00:07, 57.45it/s]
Sample:  56%|█████▋    | 564/1000 [00:09&lt;00:07, 57.46it/s]
Sample:  57%|█████▋    | 570/1000 [00:09&lt;00:07, 57.48it/s]
Sample:  58%|█████▊    | 576/1000 [00:10&lt;00:07, 57.53it/s]
Sample:  58%|█████▊    | 582/1000 [00:10&lt;00:07, 57.53it/s]
Sample:  59%|█████▉    | 588/1000 [00:10&lt;00:07, 57.51it/s]
Sample:  59%|█████▉    | 594/1000 [00:10&lt;00:07, 57.52it/s]
Sample:  60%|██████    | 600/1000 [00:10&lt;00:06, 57.50it/s]
Sample:  61%|██████    | 606/1000 [00:10&lt;00:06, 57.52it/s]
Sample:  61%|██████    | 612/1000 [00:10&lt;00:06, 57.51it/s]
Sample:  62%|██████▏   | 618/1000 [00:10&lt;00:06, 57.53it/s]
Sample:  62%|██████▏   | 624/1000 [00:10&lt;00:06, 57.36it/s]
Sample:  63%|██████▎   | 630/1000 [00:10&lt;00:06, 57.43it/s]
Sample:  64%|██████▎   | 636/1000 [00:11&lt;00:06, 57.47it/s]
Sample:  64%|██████▍   | 642/1000 [00:11&lt;00:06, 57.35it/s]
Sample:  65%|██████▍   | 648/1000 [00:11&lt;00:06, 57.37it/s]
Sample:  65%|██████▌   | 654/1000 [00:11&lt;00:06, 56.92it/s]
Sample:  66%|██████▌   | 660/1000 [00:11&lt;00:05, 57.11it/s]
Sample:  67%|██████▋   | 666/1000 [00:11&lt;00:05, 57.26it/s]
Sample:  67%|██████▋   | 672/1000 [00:11&lt;00:05, 57.23it/s]
Sample:  68%|██████▊   | 678/1000 [00:11&lt;00:05, 57.23it/s]
Sample:  68%|██████▊   | 684/1000 [00:11&lt;00:05, 57.38it/s]
Sample:  69%|██████▉   | 690/1000 [00:12&lt;00:05, 57.50it/s]
Sample:  70%|██████▉   | 696/1000 [00:12&lt;00:05, 57.51it/s]
Sample:  70%|███████   | 702/1000 [00:12&lt;00:05, 57.48it/s]
Sample:  71%|███████   | 708/1000 [00:12&lt;00:05, 57.43it/s]
Sample:  71%|███████▏  | 714/1000 [00:12&lt;00:04, 57.51it/s]
Sample:  72%|███████▏  | 720/1000 [00:12&lt;00:04, 57.56it/s]
Sample:  73%|███████▎  | 726/1000 [00:12&lt;00:04, 57.46it/s]
Sample:  73%|███████▎  | 732/1000 [00:12&lt;00:04, 57.53it/s]
Sample:  74%|███████▍  | 738/1000 [00:12&lt;00:04, 57.45it/s]
Sample:  74%|███████▍  | 744/1000 [00:12&lt;00:04, 57.54it/s]
Sample:  75%|███████▌  | 750/1000 [00:13&lt;00:04, 57.61it/s]
Sample:  76%|███████▌  | 756/1000 [00:13&lt;00:04, 57.51it/s]
Sample:  76%|███████▌  | 762/1000 [00:13&lt;00:04, 57.51it/s]
Sample:  77%|███████▋  | 768/1000 [00:13&lt;00:04, 57.50it/s]
Sample:  77%|███████▋  | 774/1000 [00:13&lt;00:03, 57.55it/s]
Sample:  78%|███████▊  | 780/1000 [00:13&lt;00:03, 57.55it/s]
Sample:  79%|███████▊  | 786/1000 [00:13&lt;00:03, 57.54it/s]
Sample:  79%|███████▉  | 792/1000 [00:13&lt;00:03, 57.60it/s]
Sample:  80%|███████▉  | 798/1000 [00:13&lt;00:03, 57.60it/s]
Sample:  80%|████████  | 804/1000 [00:13&lt;00:03, 57.49it/s]
Sample:  81%|████████  | 810/1000 [00:14&lt;00:03, 57.57it/s]
Sample:  82%|████████▏ | 816/1000 [00:14&lt;00:03, 57.41it/s]
Sample:  82%|████████▏ | 822/1000 [00:14&lt;00:03, 57.39it/s]
Sample:  83%|████████▎ | 828/1000 [00:14&lt;00:02, 57.43it/s]
Sample:  83%|████████▎ | 834/1000 [00:14&lt;00:02, 57.60it/s]
Sample:  84%|████████▍ | 840/1000 [00:14&lt;00:02, 57.72it/s]
Sample:  85%|████████▍ | 846/1000 [00:14&lt;00:02, 57.72it/s]
Sample:  85%|████████▌ | 852/1000 [00:14&lt;00:02, 57.66it/s]
Sample:  86%|████████▌ | 858/1000 [00:14&lt;00:02, 57.64it/s]
Sample:  86%|████████▋ | 864/1000 [00:15&lt;00:02, 57.67it/s]
Sample:  87%|████████▋ | 870/1000 [00:15&lt;00:02, 57.69it/s]
Sample:  88%|████████▊ | 876/1000 [00:15&lt;00:02, 57.68it/s]
Sample:  88%|████████▊ | 882/1000 [00:15&lt;00:02, 57.68it/s]
Sample:  89%|████████▉ | 888/1000 [00:15&lt;00:01, 57.72it/s]
Sample:  89%|████████▉ | 894/1000 [00:15&lt;00:01, 57.82it/s]
Sample:  90%|█████████ | 900/1000 [00:15&lt;00:01, 57.76it/s]
Sample:  91%|█████████ | 906/1000 [00:15&lt;00:01, 57.76it/s]
Sample:  91%|█████████ | 912/1000 [00:15&lt;00:01, 57.79it/s]
Sample:  92%|█████████▏| 918/1000 [00:15&lt;00:01, 57.81it/s]
Sample:  92%|█████████▏| 924/1000 [00:16&lt;00:01, 57.84it/s]
Sample:  93%|█████████▎| 930/1000 [00:16&lt;00:01, 57.75it/s]
Sample:  94%|█████████▎| 936/1000 [00:16&lt;00:01, 57.78it/s]
Sample:  94%|█████████▍| 942/1000 [00:16&lt;00:01, 57.80it/s]
Sample:  95%|█████████▍| 948/1000 [00:16&lt;00:00, 57.80it/s]
Sample:  95%|█████████▌| 954/1000 [00:16&lt;00:00, 57.73it/s]
Sample:  96%|█████████▌| 960/1000 [00:16&lt;00:00, 57.70it/s]
Sample:  97%|█████████▋| 966/1000 [00:16&lt;00:00, 57.64it/s]
Sample:  97%|█████████▋| 972/1000 [00:16&lt;00:00, 57.60it/s]
Sample:  98%|█████████▊| 978/1000 [00:17&lt;00:00, 57.59it/s]
Sample:  98%|█████████▊| 984/1000 [00:17&lt;00:00, 57.59it/s]
Sample:  99%|█████████▉| 990/1000 [00:17&lt;00:00, 57.50it/s]
Sample: 100%|█████████▉| 996/1000 [00:17&lt;00:00, 57.54it/s]
Sample: 100%|██████████| 1000/1000 [00:17&lt;00:00, 57.48it/s]
</pre></div>
</div>
</section>
<section id="id1">
<h2>Analyze results<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Again we can inspect the results.
Here we notice the posterior distribution matches the exact solution much better.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot credible intervals for the signal</span>
<span class="n">samples_Ld</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_ci</span><span class="p">(</span><span class="n">exact</span><span class="o">=</span><span class="n">probinfo</span><span class="o">.</span><span class="n">exactSolution</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_gibbs_005.png" srcset="../../_images/sphx_glr_gibbs_005.png" alt="gibbs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D object at 0x7fa8ae38a2a0&gt;, &lt;matplotlib.lines.Line2D object at 0x7fa8ae38acc0&gt;, &lt;matplotlib.collections.FillBetweenPolyCollection object at 0x7fa8b0106e70&gt;]
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples_Ld</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_gibbs_006.png" srcset="../../_images/sphx_glr_gibbs_006.png" alt="d, d" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;d&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;d&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples_Ld</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_gibbs_007.png" srcset="../../_images/sphx_glr_gibbs_007.png" alt="l, l" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;l&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;l&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 29.865 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-user-auto-howtos-gibbs-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ad539661b9e78dd9062c252d30c66918/gibbs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">gibbs.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b274f5c1c772585148d67b4720d2e9a7/gibbs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">gibbs.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c0cdf497d7a8eb8b8c97bef6b285ff9c/gibbs.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">gibbs.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-model-and-data">Forward model and data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-bayesian-model">Hierarchical Bayesian model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-posterior-distribution">Defining the posterior distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gibbs-sampler">Gibbs Sampler</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-results">Analyze results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#switching-to-a-piecewise-constant-prior">Switching to a piecewise constant prior</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hybridgibbs-sampler-with-laplace-prior">HybridGibbs Sampler (with Laplace prior)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Analyze results</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/_auto_howtos/gibbs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022, CUQI Project, Technical University of Denmark (DTU).
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>